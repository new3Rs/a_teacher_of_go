/*! For license information please see main.d03ea2e3.chunk.js.LICENSE.txt */
(this.webpackJsonpa_teacher_of_go=this.webpackJsonpa_teacher_of_go||[]).push([[0],{24:function(t,e,n){t.exports=n(42)},29:function(t,e,n){},42:function(t,e,n){"use strict";n.r(e);var a=n(1),r=n.n(a),s=n(16),i=n.n(s),o=(n(29),n(0)),l=n.n(o),c=n(2),u=n(7),h=n(5),d=n(3),f=n(4),p=n(9),v=n(6),m=n(8),y=n(12),k=n.n(y);function g(t){return Math.floor(Math.random()*t)}function b(t){return w.apply(this,arguments)}function w(){return(w=Object(c.a)(l.a.mark((function t(e){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){setTimeout(t,e)})));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var x=n(23),A=n(22),O=n.n(A);function S(t){var e=t.charCodeAt(0);return[(e<"I".charCodeAt(0)?e+1:e)-"A".charCodeAt(0),parseInt(t.slice(1))]}function T(t,e){return["@","A","B","C","D","E","F","G","H","J","K","L","M","N","O","P","Q","R","S","T"][t]+e}function E(t){switch(t){case 1:return 2;case 2:return 1;default:return 0}}var H=function(){function t(e){Object(d.a)(this,t),this.value=void 0,this.marks=void 0,this.value=0,this.marks=new Int32Array(e)}return Object(f.a)(t,[{key:"clear",value:function(){this.value+=1}},{key:"isMarked",value:function(t){return this.marks[t]===this.value}},{key:"mark",value:function(t){this.marks[t]=this.value}}]),t}(),I=function(){function t(e,n){Object(d.a)(this,t),this.WIDTH=void 0,this.HEIGHT=void 0,this.LENGTH=void 0,this.marker1=void 0,this.marker2=void 0,this.state=void 0,this.turn=void 0,this.ko=void 0,this.passes=void 0,this.WIDTH=e,this.HEIGHT=n,this.LENGTH=this.WIDTH*this.HEIGHT,this.state=new Uint8Array(this.LENGTH),this.turn=1,this.marker1=new H(this.LENGTH),this.marker2=new H(this.LENGTH),this.ko=null,this.passes=0}return Object(f.a)(t,null,[{key:"copy",value:function(e){var n=new t(e.WIDTH,e.HEIGHT);return n.state.set(e.state),n.turn=e.turn,n.ko=e.ko,n.passes=e.passes,n}},{key:"fromSgf",value:function(t){var e=O.a.fastParse(t),n=Object(u.a)(e,1)[0],a=19,r=19;if(n.SZ)if(/^[0-9]{1,2}$/.test(n.SZ))r=a=parseInt(n.SZ);else{var s=n.SZ.match(/^([0-9]{1,2}):([0-9]{1,2})$/);s&&(a=parseInt(s[1]),r=parseInt(s[2]))}for(var i=new this(a,r),o=n;o._children.length>0;){var l=void 0;if(null!=(o=o._children[0]).B)l=o.B;else{if(null==o.W)continue;l=o.W}i.play(i.xyToPoint.apply(i,i.moveToXy(l)))}return i}}]),Object(f.a)(t,[{key:"clear",value:function(){this.state=new Uint8Array(this.LENGTH),this.turn=1,this.ko=null,this.passes=0}},{key:"opponent",value:function(){return E(this.turn)}},{key:"switchTurn",value:function(){this.turn=E(this.turn)}},{key:"getState",value:function(t){return this.state[t]}},{key:"setState",value:function(t,e){this.state[t]=e}},{key:"removeString",value:function(t){var e,n=Object(h.a)(t.points);try{for(n.s();!(e=n.n()).done;){var a=e.value;this.setState(a,0)}}catch(r){n.e(r)}finally{n.f()}}},{key:"captureBy",value:function(t){var e,n=this.opponent(),a=[],r=Object(h.a)(this.adjacenciesAt(t));try{for(r.s();!(e=r.n()).done;){var s=e.value;if(this.getState(s)===n){var i=this.stringAt(s);i&&0===i.liberties.length&&(this.removeString(i),a.push.apply(a,i.points))}}}catch(o){r.e(o)}finally{r.f()}return a}},{key:"stringAt",value:function(t){var e=this.getState(t);if(0===e||3===e)return null;var n=E(e),a=new R;this.marker1.clear(),this.marker2.clear(),a.points.push(t),this.marker2.mark(t);for(var r=0;r<a.points.length;r++){var s=a.points[r];if(!this.marker1.isMarked(s)){this.marker1.mark(s);var i,o=Object(h.a)(this.adjacenciesAt(s));try{for(o.s();!(i=o.n()).done;){var l=i.value;if(!this.marker1.isMarked(l)){var c=this.getState(l);c===e?this.marker2.isMarked(l)||(a.points.push(l),this.marker2.mark(l)):(this.marker1.mark(l),c===n?a.opponents.push(l):0===c&&a.liberties.push(l))}}}catch(u){o.e(u)}finally{o.f()}}}return a}},{key:"connectedEmptiesAt",value:function(t){if(0!==this.getState(t))return null;var e=new j;this.marker1.clear(),this.marker2.clear(),e.points.push(t),this.marker2.mark(t);for(var n=0;n<e.points.length;n++){var a=e.points[n];if(!this.marker1.isMarked(a)){this.marker1.mark(a);var r,s=Object(h.a)(this.adjacenciesAt(a));try{for(s.s();!(r=s.n()).done;){var i=r.value;if(!this.marker1.isMarked(i)){var o=this.getState(i);0===o?this.marker2.isMarked(i)||(e.points.push(i),this.marker2.mark(i)):(this.marker1.mark(i),1===o?e.blacks.push(i):2===o&&e.whites.push(i))}}}catch(l){s.e(l)}finally{s.f()}}}return e}},{key:"play",value:function(t){var e=this.turn,n=this.ko;if(-1===t)return this.passes+=1,this.ko=null,this.switchTurn(),new D(e,t,n,[],null);if(0!==this.getState(t))return null;if(this.passes=0,t===n)return this.ko=null,this.switchTurn(),new D(e,t,n,[t],null);this.setState(t,this.turn);var a=this.captureBy(t),r=this.stringAt(t);if(null==r)throw new Error("should not reach here");var s=r.liberties.length;if(1===a.length&&1===s&&1===r.points.length?this.ko=r.liberties[0]:this.ko=null,this.switchTurn(),0===s){var i,o=Object(h.a)(r.points);try{for(o.s();!(i=o.n()).done;){var l=i.value;this.setState(l,0)}}catch(c){o.e(c)}finally{o.f()}return new D(e,t,n,r.points,null)}return new D(e,t,n,a,r)}},{key:"undoPlay",value:function(t){if(this.ko=t.ko,this.switchTurn(),-1!==t.point){if(t.captives.includes(t.point)){var e,n=Object(h.a)(t.captives);try{for(n.s();!(e=n.n()).done;){var a=e.value;this.setState(a,t.turn)}}catch(l){n.e(l)}finally{n.f()}}else{var r,s=E(t.turn),i=Object(h.a)(t.captives);try{for(i.s();!(r=i.n()).done;){var o=r.value;this.setState(o,s)}}catch(l){i.e(l)}finally{i.f()}}this.setState(t.point,0)}}},{key:"isLegal",value:function(t){var e=this.play(t);return!!e&&(this.undoPlay(e),!0)}},{key:"xyToPoint",value:function(t,e){return t-1+(e-1)*this.WIDTH}},{key:"pointToXy",value:function(t){var e=Math.floor(t/this.WIDTH);return[t-e*this.WIDTH+1,e+1]}},{key:"moveToXy",value:function(t){var e="a".charCodeAt(0)-1;return[t.charCodeAt(0)-e,t.charCodeAt(1)-e]}},{key:"adjacenciesAt",value:function(t){for(var e=this.pointToXy(t),n=[],a=0,r=[[0,-1],[-1,0],[1,0],[0,1]];a<r.length;a++){var s=r[a],i=e[0]+s[0],o=e[1]+s[1];i>=1&&i<=this.WIDTH&&o>=1&&o<=this.HEIGHT&&n.push(this.xyToPoint(i,o))}return n}},{key:"diagonalsAt",value:function(t){for(var e=this.pointToXy(t),n=[],a=0,r=[[-1,-1],[-1,1],[1,-1],[1,-1]];a<r.length;a++){var s=r[a],i=e[0]+s[0],o=e[1]+s[1];i>=1&&i<=this.WIDTH&&o>=1&&o<=this.HEIGHT&&n.push(this.xyToPoint(i,o))}return n}},{key:"toString",value:function(){for(var t="",e=1;e<=this.HEIGHT;e++){for(var n=1;n<=this.WIDTH;n++)switch(this.getState(this.xyToPoint(n,e))){case 3:t+="#";break;case 0:t+=".";break;case 1:t+="X";break;case 2:t+="O"}t+="\n"}return t}}]),t}(),R=function t(){Object(d.a)(this,t),this.points=void 0,this.liberties=void 0,this.opponents=void 0,this.points=[],this.liberties=[],this.opponents=[]},j=function t(){Object(d.a)(this,t),this.points=void 0,this.blacks=void 0,this.whites=void 0,this.points=[],this.blacks=[],this.whites=[]},D=function t(e,n,a,r,s){Object(d.a)(this,t),this.turn=void 0,this.point=void 0,this.ko=void 0,this.captives=void 0,this.string=void 0,this.turn=e,this.point=n,this.ko=a,this.captives=r,this.string=s},W=function(){function t(e){Object(d.a)(this,t),this.src=e,this.forcePlay=!1,this.state=this.constructor.NO_SOURCE,this.sources=[]}return Object(f.a)(t,null,[{key:"initClass",value:function(){this.NO_SOURCE=0,this.LOADING=1,this.LOADED=2,window.AudioContext?this.context=new window.AudioContext:window.webkitAudioContext&&(this.context=new window.webkitAudioContext),window.addEventListener("click",(function e(){t.unlock(),window.removeEventListener("click",e)}))}},{key:"unlock",value:function(){this.context.resume&&this.context.resume();var t=this.context.createBufferSource();t.buffer=this.context.createBuffer(1,1,22050),t.connect(this.context.destination),t.onended=function(){t.disconnect()},t.start=t.start||t.noteOn,t.stop=t.stop||t.noteOff,t.start(0)}}]),Object(f.a)(t,[{key:"load",value:function(t){var e=this,n=new XMLHttpRequest;n.open("GET",this.src),n.responseType="arraybuffer",n.onload=function(){return e.constructor.context.decodeAudioData(n.response,(function(n){e.buffer=n,e.state=e.constructor.LOADED,e.forcePlay&&e.play(t)}),(function(t){console.log("decodeAudioData error: ",t),e.state=e.constructor.NO_SOURCE}))},n.send(),this.state=this.constructor.LOADING}},{key:"play",value:function(t){var e=this;switch(this.state){case this.constructor.NO_SOURCE:this.forcePlay=!0,this.load(t);break;case this.constructor.LOADING:this.forcePlay=!0;break;case this.constructor.LOADED:var n=this.constructor.context.createBufferSource();n.start=n.start||n.noteOn,n.stop=n.stop||n.noteOff,n.buffer=this.buffer;var a,r,s=n;if(t&&null!=t.volume&&((a=this.constructor.context.createGain()).gain.value=t.volume,s.connect(a),s=a),t&&null!=t.pan){(r=this.constructor.context.createPanner()).panningModel="equalpower";var i=t.pan;i>90&&(i=180-i),r.setPosition(Math.sin(t.pan*Math.PI/180),0,Math.sin(i*Math.PI/180)),s.connect(r),s=r}s.connect(this.constructor.context.destination),n.onended=function(){n.disconnect(),a&&a.disconnect(),r&&r.disconnect(),e.sources.splice(e.sources.indexOf(n),1)},n.start(0),this.sources.push(n)}}},{key:"pause",value:function(){this.sources.forEach((function(t){t.stop(0)})),this.sources=[]}}]),t}();W.initClass();var M=W,B=new M("sounds/jump01.mp3"),C=new M("sounds/jump10.mp3"),G=new M("sounds/powerdown07.mp3");function z(t,e,n,a,r,s){var i;switch(e.type){case"x-shader/x-vertex":i=t.VERTEX_SHADER;break;case"x-shader/x-fragment":i=t.FRAGMENT_SHADER;break;default:return}var o=t.createShader(i);if(t.shaderSource(o,e.text.replace(/%BOARD_WIDTH%/g,r).replace(/%BOARD_HEIGHT%/g,s).replace(/%WIDTH%/g,n).replace(/%HEIGHT%/g,a)),t.compileShader(o),!t.getShaderParameter(o,t.COMPILE_STATUS))throw new Error("Shader compile failed with: "+t.getShaderInfoLog(o));return o}var L=function(){function t(e,n,a,r){Object(d.a)(this,t),this.stoneSize=e,this.boardWidth=n,this.boardHeight=a,this.shadowRoot=r,this.drawing=!1,this.listeners={};var s=r.querySelector("#goban");this.territory=r.querySelector("#territory"),this.stones=r.querySelector("#stones");var i=parseInt(s.getAttribute("width")),o=parseInt(s.getAttribute("height"));this.territory.setAttribute("width",i),this.territory.setAttribute("height",o),this.stones.width=i,this.stones.height=o,this.gl=this.stones.getContext("webgl"),this.vertexShader=z(this.gl,r.getElementById("vs"),i,o,n,a),this.fragmentShader=z(this.gl,r.getElementById("fs"),i,o,n,a),this.program=this.gl.createProgram(),this.gl.attachShader(this.program,this.vertexShader),this.gl.attachShader(this.program,this.fragmentShader),this.gl.linkProgram(this.program),this.gl.useProgram(this.program);var l=new Float32Array([-1,1,-1,-1,1,1,1,-1]),c=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,c),this.gl.bufferData(this.gl.ARRAY_BUFFER,l,this.gl.STATIC_DRAW);var u=function(t,e,n){var a=t.getAttribLocation(e,n);if(-1===a)throw new Error("Can not find attribute "+n+".");return a}(this.gl,this.program,"position");this.gl.enableVertexAttribArray(u),this.gl.vertexAttribPointer(u,2,this.gl.FLOAT,this.gl.FALSE,8,0),this.stonesHandle=function(t,e,n){var a=t.getUniformLocation(e,n);if(-1===a)throw new Error("Can not find uniform "+n+".");return a}(this.gl,this.program,"states"),this.leaves=r.getElementById("leaves"),this.clickHandler=this.constructor.prototype.clickHandler.bind(this),this.stones.addEventListener("click",this.clickHandler,!1)}return Object(f.a)(t,[{key:"destroy",value:function(){this.stones.removeEventListener("click",this.clickHandler,!1),this.gl.deleteProgram(this.program),this.gl.deleteShader(this.fragmentShader),this.gl.deleteShader(this.vertexShader)}},{key:"xyToPoint",value:function(t,e){return t-1+(e-1)*this.boardWidth}},{key:"pointToXy",value:function(t){var e=Math.floor(t/this.boardWidth);return[t-e*this.boardWidth+1,e+1]}},{key:"drawStone",value:function(){var t=Object(c.a)(l.a.mark((function t(e,n,a){var r,s,i,o,c,u,d,f,p,v,m,y,k,g=this,b=arguments;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=b.length>3&&void 0!==b[3]?b[3]:[],this.drawing=!0,t.prev=2,s=500,i=this.gl,o=e.slice(),r.includes(a)){c=Object(h.a)(r);try{for(c.s();!(u=c.n()).done;)d=u.value,o[d]=n}catch(l){c.e(l)}finally{c.f()}}else{f=-n,p=Object(h.a)(r);try{for(p.s();!(v=p.n()).done;)m=v.value,o[m]=f}catch(l){p.e(l)}finally{p.f()}}if(null==a){t.next=13;break}return 1===n?B.play():C.play(),t.next=11,new Promise((function(t,e){var n=Date.now();!function e(){for(var r=new Float32Array(o.length),l=Date.now()-n,c=g.stoneSize/2*Math.min(l/s,1),u=0;u<o.length;u++)r[u]=o[u]*(u===a?c:g.stoneSize/2);i.uniform1fv(g.stonesHandle,r),i.drawArrays(i.TRIANGLE_STRIP,0,4),l<=s?requestAnimationFrame(e):t()}()}));case 11:t.next=17;break;case 13:for(y=new Float32Array(o.length),k=0;k<o.length;k++)y[k]=o[k]*this.stoneSize/2;i.uniform1fv(this.stonesHandle,y),i.drawArrays(i.TRIANGLE_STRIP,0,4);case 17:if(this.updateLeaves(e),this.updateTerritory(e),!(r.length>0)){t.next=23;break}return G.play(),t.next=23,new Promise((function(t,e){var n=Date.now();!function e(){for(var a=new Float32Array(o.length),l=Date.now()-n,c=g.stoneSize/2*Math.max((s-l)/s,0),u=0;u<o.length;u++)a[u]=o[u]*(r.includes(u)?c:g.stoneSize/2);i.uniform1fv(g.stonesHandle,a),i.drawArrays(i.TRIANGLE_STRIP,0,4),l<=s?requestAnimationFrame(e):t()}()}));case 23:t.next=28;break;case 25:t.prev=25,t.t0=t.catch(2),console.error(t.t0);case 28:return t.prev=28,this.drawing=!1,t.finish(28);case 31:case"end":return t.stop()}}),t,this,[[2,25,28,31]])})));return function(e,n,a){return t.apply(this,arguments)}}()},{key:"updateLeaves",value:function(t){for(var e=0;e<this.boardWidth*this.boardHeight;e++){var n=this.leaves.getElementById("leaf-".concat(e));t[e]?(n.removeAttribute("display"),n.setAttribute("style",t[e]>0?"fill:#004d00;stroke:none":"fill:#00ff00;stroke:none")):n.setAttribute("display","none")}}},{key:"updateTerritory",value:function(t){for(var e=this,n=new I(this.boardWidth,this.boardHeight),a=0,r=1;r<=this.boardHeight;r++)for(var s=1;s<=this.boardWidth;s++)switch(t[this.xyToPoint(s,r)]){case 1:n.setState(n.xyToPoint(s,r),1),a+=1;break;case-1:n.setState(n.xyToPoint(s,r),2),a+=1;break;default:n.setState(n.xyToPoint(s,r),0)}if(a<=1)for(var i=0;i<t.length;i++){this.territory.getElementById("territory-".concat(i)).setAttribute("display","none")}else for(var o=[],l=function(t){var a=e.pointToXy(t),r=Object(u.a)(a,2),s=r[0],i=r[1],l=n.xyToPoint(s,i),c=e.territory.getElementById("territory-".concat(t));if(0!==n.getState(l))return c.setAttribute("display","none"),"continue";var h=o.find((function(t){return t.points.includes(l)}));null==h&&(h=n.connectedEmptiesAt(l),o.push(h)),h.blacks.length>0&&0===h.whites.length?(c.removeAttribute("display"),c.setAttribute("style","fill:#004d00;stroke:#004d00")):0===h.blacks.length&&h.whites.length>0?(c.removeAttribute("display"),c.setAttribute("style","fill:#00ff00;stroke:#00ff00")):c.setAttribute("display","none")},c=0;c<t.length;c++)l(c)}},{key:"addEventListener",value:function(t,e){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e)}},{key:"removeEventListener",value:function(t,e){this.listeners[t]&&(e?function(t,e){var n=t.indexOf(e);n<0||t.splice(n,1)}(this.listeners[t],e):this.listeners[t]=[])}},{key:"clickHandler",value:function(t){var e=t.currentTarget.getBoundingClientRect(),n=this.shadowRoot.querySelector("#stones"),a=Math.floor(this.boardWidth*(t.clientX-e.left)/n.offsetWidth)+1,r=Math.floor(this.boardHeight*(t.clientY-e.top)/n.offsetHeight)+1;if(this.listeners.click){var s,i=Object(h.a)(this.listeners.click);try{for(i.s();!(s=i.n()).done;){(0,s.value)(a,r)}}catch(o){i.e(o)}finally{i.f()}}}}]),t}();(function(t){Object(v.a)(n,t);var e=Object(m.a)(n);function n(){var t;Object(d.a)(this,n);var a=(t=e.call(this)).attachShadow({mode:"open"}),r=t.template.content.cloneNode(!0);return a.appendChild(r),null!=t.dataset.stoneSize&&null!=t.dataset.width&&null!=t.dataset.height&&t.initialize(parseFloat(t.dataset.stoneSize),parseInt(t.dataset.width),parseInt(t.dataset.height)),t}return Object(f.a)(n,null,[{key:"init",value:function(){var t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttributeNS(null,"version","1.1"),t.setAttribute("xmlns","http://www.w3.org/2000/svg"),t.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),t.setAttribute("width","0"),t.setAttribute("height","0"),t.innerHTML='\n<defs>\n    <path id="two-leaves" d="M196.036,292.977c-16.781-18.297,21.344-105.25-166.266-192.188c-33.563,6.094-79.328,160.156,118.984,212.031\n    c65.594,21.344,57.969,94.563,57.969,122.016h38.125c0,0-15.594-87.094,54.078-119.016\n    c47.406-21.688,178.328-28.656,213.078-224.281c-66.234-38.313-281.625-7.75-276.266,186.313\n    c-3.141,27.297-4.703,50.422-19.875,44.109C197.567,314.336,196.036,292.977,196.036,292.977z" opacity="0.5" />\n</defs>\n<defs>\n    <g id="seedlings">\n        <use xlink:href="#two-leaves" transform="translate(-80,-80) scale(0.07,0.07)"></use>\n        <use xlink:href="#two-leaves" transform="translate(-15,-80) scale(0.07,0.07)"></use>\n        <use xlink:href="#two-leaves" transform="translate(55,-80) scale(0.07,0.07)"></use>\n        <use xlink:href="#two-leaves" transform="translate(120,-80) scale(0.07,0.07)"></use>\n        <use xlink:href="#two-leaves" transform="translate(-60,-15) scale(0.07,0.07)"></use>\n        <use xlink:href="#two-leaves" transform="translate(15,-15) scale(0.07,0.07)"></use>\n        <use xlink:href="#two-leaves" transform="translate(75,-15) scale(0.07,0.07)"></use>\n        <use xlink:href="#two-leaves" transform="translate(140,-15) scale(0.07,0.07)"></use>\n        <use xlink:href="#two-leaves" transform="translate(-80,55) scale(0.07,0.07)"></use>\n        <use xlink:href="#two-leaves" transform="translate(-15,55) scale(0.07,0.07)"></use>\n        <use xlink:href="#two-leaves" transform="translate(55,55) scale(0.07,0.07)"></use>\n        <use xlink:href="#two-leaves" transform="translate(120,55) scale(0.07,0.07)"></use>\n        <use xlink:href="#two-leaves" transform="translate(-60,120) scale(0.07,0.07)"></use>\n        <use xlink:href="#two-leaves" transform="translate(15,120) scale(0.07,0.07)"></use>\n        <use xlink:href="#two-leaves" transform="translate(75,120) scale(0.07,0.07)"></use>\n        <use xlink:href="#two-leaves" transform="translate(140,120) scale(0.07,0.07)"></use>\n    </g>\n</defs>\n<defs>\n    <path\n    id="leaf"\n    d="m 0,-145 c -5.36199,-1.5478604 -14.21002,-8.6465004 -15.2827,-22.05113 -1.07198,-13.40533 13.94132,-32.17336 16.35468,-37.80264 2.41335,-5.63069 5.89798,0.53528 10.72469,5.36199 4.826,4.82601 31.099959,32.70794 -3.21876,54.1573096 -2.1991,1.3477504 -2.12414,2.5074104 -1.84201,5.7565604 0.4773,5.48079 1.34068,4.67681 0.86479,5.39169 -0.94116,1.41068 -4.76802,1.98344 -4.7666,0.4773 -0.001,-8.58004 -3.771,-25.1482604 -0.50983,-37.92426 4.29002,-16.80157 1.5521,-19.18452 1.5521,-19.18452 0,0 -1.6617,10.93895 -3.51856,18.29286 -4.46821,17.69534958 -0.3578,27.52484 -0.3578,27.52484 z"/>\n</defs>\n<defs>\n    <g id="four-leaves">\n        <use xlink:href="#leaf" transform="rotate(0)" />\n        <use xlink:href="#leaf" transform="rotate(90)" />\n        <use xlink:href="#leaf" transform="rotate(180)" />\n        <use xlink:href="#leaf" transform="rotate(270)" />\n    </g>\n</defs>\n',document.body.appendChild(t),this.prototype.template=document.createElement("template"),this.prototype.template.id="allelo-board",this.prototype.template.innerHTML='\n<style>\n    :host {\n        display: inline-block;  /* or display: block; */\n    }\n    .container {\n        position: relative;\n        padding: 10px;\n    }\n    canvas {\n        display: block; /* \u30c7\u30d5\u30a9\u30eb\u30c8\u306einline\u306e\u307e\u307e\u3060\u3068canvas\u306e\u4e0b\u306b\u9699\u9593\u304c\u5165\u308b */\n    }\n    #goban {\n        position: relative;\n    }\n    #territory, #leaves, #stones, #bans {\n        position: absolute;\n        top: 10px; /* .container\u306epadding\u3068\u540c\u3058\u5024 TODO \u30ea\u30d5\u30a1\u30af\u30bf\u30ea\u30f3\u30b0 */\n        left: 10px; /* .container\u306epadding\u3068\u540c\u3058\u5024 TODO \u30ea\u30d5\u30a1\u30af\u30bf\u30ea\u30f3\u30b0 */\n    }\n    svg * {\n        width: 100%;\n        height: 100%;\n    }\n    #bans {\n        pointer-events: none;\n    }\n</style>\n<div class="container", style="background-color: orange;">\n    <canvas id="goban"></canvas>\n    <svg id="territory" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <defs>\n            <path id="two-leaves" d="M196.036,292.977c-16.781-18.297,21.344-105.25-166.266-192.188c-33.563,6.094-79.328,160.156,118.984,212.031\n            c65.594,21.344,57.969,94.563,57.969,122.016h38.125c0,0-15.594-87.094,54.078-119.016\n            c47.406-21.688,178.328-28.656,213.078-224.281c-66.234-38.313-281.625-7.75-276.266,186.313\n            c-3.141,27.297-4.703,50.422-19.875,44.109C197.567,314.336,196.036,292.977,196.036,292.977z" opacity="0.5" />\n        </defs>\n        <defs>\n            <g id="seedlings">\n                <use xlink:href="#two-leaves" transform="translate(-80,-80) scale(0.07,0.07)"></use>\n                <use xlink:href="#two-leaves" transform="translate(-15,-80) scale(0.07,0.07)"></use>\n                <use xlink:href="#two-leaves" transform="translate(55,-80) scale(0.07,0.07)"></use>\n                <use xlink:href="#two-leaves" transform="translate(120,-80) scale(0.07,0.07)"></use>\n                <use xlink:href="#two-leaves" transform="translate(-60,-15) scale(0.07,0.07)"></use>\n                <use xlink:href="#two-leaves" transform="translate(15,-15) scale(0.07,0.07)"></use>\n                <use xlink:href="#two-leaves" transform="translate(75,-15) scale(0.07,0.07)"></use>\n                <use xlink:href="#two-leaves" transform="translate(140,-15) scale(0.07,0.07)"></use>\n                <use xlink:href="#two-leaves" transform="translate(-80,55) scale(0.07,0.07)"></use>\n                <use xlink:href="#two-leaves" transform="translate(-15,55) scale(0.07,0.07)"></use>\n                <use xlink:href="#two-leaves" transform="translate(55,55) scale(0.07,0.07)"></use>\n                <use xlink:href="#two-leaves" transform="translate(120,55) scale(0.07,0.07)"></use>\n                <use xlink:href="#two-leaves" transform="translate(-60,120) scale(0.07,0.07)"></use>\n                <use xlink:href="#two-leaves" transform="translate(15,120) scale(0.07,0.07)"></use>\n                <use xlink:href="#two-leaves" transform="translate(75,120) scale(0.07,0.07)"></use>\n                <use xlink:href="#two-leaves" transform="translate(140,120) scale(0.07,0.07)"></use>\n            </g>\n        </defs>\n    </svg>\n    <svg id="leaves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <defs>\n            <path\n            id="leaf"\n            d="m 0,-145 c -5.36199,-1.5478604 -14.21002,-8.6465004 -15.2827,-22.05113 -1.07198,-13.40533 13.94132,-32.17336 16.35468,-37.80264 2.41335,-5.63069 5.89798,0.53528 10.72469,5.36199 4.826,4.82601 31.099959,32.70794 -3.21876,54.1573096 -2.1991,1.3477504 -2.12414,2.5074104 -1.84201,5.7565604 0.4773,5.48079 1.34068,4.67681 0.86479,5.39169 -0.94116,1.41068 -4.76802,1.98344 -4.7666,0.4773 -0.001,-8.58004 -3.771,-25.1482604 -0.50983,-37.92426 4.29002,-16.80157 1.5521,-19.18452 1.5521,-19.18452 0,0 -1.6617,10.93895 -3.51856,18.29286 -4.46821,17.69534958 -0.3578,27.52484 -0.3578,27.52484 z"/>\n        </defs>\n        <defs>\n            <g id="four-leaves">\n                <use xlink:href="#leaf" transform="rotate(0)" />\n                <use xlink:href="#leaf" transform="rotate(90)" />\n                <use xlink:href="#leaf" transform="rotate(180)" />\n                <use xlink:href="#leaf" transform="rotate(270)" />\n            </g>\n        </defs>\n    </svg>\n    <canvas id="stones"></canvas>\n    <canvas id="bans"></canvas>\n</div>\n<script id="vs" type="x-shader/x-vertex">\n    attribute vec2 position;\n\n    void main() {\n        // position specifies only x and y.\n        // We set z to be 0.0, and w to be 1.0\n        gl_Position = vec4(position, 0.0, 1.0);\n    }\n<\/script>\n<script id="fs" type="x-shader/x-fragment">\n    precision lowp float;\n    const int BOARD_WIDTH = %BOARD_WIDTH%;\n    const int BOARD_HEIGHT = %BOARD_HEIGHT%;\n    const float WIDTH = %WIDTH%.0;\n    const float HEIGHT = %HEIGHT%.0;\n    uniform float states[BOARD_WIDTH * BOARD_HEIGHT];\n    \n    void main() {\n        float _width = WIDTH / float(BOARD_WIDTH) / 2.0;\n        float _height = HEIGHT / float(BOARD_HEIGHT) / 2.0;\n        float x = gl_FragCoord.x;\n        float y = gl_FragCoord.y;\n        float b = 0.0;\n        float w = 0.0;\n        for (int j = 0; j < BOARD_HEIGHT; j++) {\n            for (int i = 0; i < BOARD_WIDTH; i++) {\n                float r = states[i + j * BOARD_WIDTH];\n                float dx = _width + float(i) * 2.0 * _width - x;\n                float dy = _height + float(j) * 2.0 * _height - (HEIGHT - y);\n                float ratio = r*r/(dx*dx + dy*dy);\n                ratio = ratio * ratio;\n                ratio = ratio * ratio;\n                ratio = ratio * ratio;\n                if (r > 0.0) {\n                    b += ratio;\n                } else {\n                    w += ratio;\n                }\n            }\n        }\n        float alpha = float(b > 1.0 || w > 1.0);\n        float white = float(w > 1.0);\n        // gl_FragColor = vec4(0.0, white + 0.3, 0.0, alpha);\n        // Firefox 61\u306falpha\u304c0\u3067\u3082\u8272\u304c\u900f\u904e\u306b\u5f71\u97ff\u3059\u308b\u306e\u3067\u305d\u306e\u30ef\u30fc\u30af\u30a2\u30e9\u30a6\u30f3\u30c9\u3067alpha\u3092\u8272\u306b\u3082\u639b\u3051\u308b\u3002\n        gl_FragColor = vec4(0.0, (white + 0.3) * alpha, 0.0, alpha);\n    }\n<\/script>\n',customElements.define("allelo-board",this)}}]),Object(f.a)(n,[{key:"connectedCallback",value:function(){console.log("connectedCallback")}},{key:"disconnectedCallback",value:function(){console.log("disconnectedCallback")}},{key:"adoptedCallback",value:function(){console.log("adoptedCallback")}},{key:"attributeChangedCallback",value:function(t,e,n){null==this.alleloBoard&&null!=this.dataset.stoneSize&&null!=this.dataset.width&&null!=this.dataset.height&&this.initialize(parseFloat(this.dataset.stoneSize),parseInt(this.dataset.width),parseInt(this.dataset.height))}},{key:"drawGround",value:function(t,e){var n=this,a=t.getContext("2d");a.lineWidth=1,a.strokeStyle="rgb(0, 0, 0)";var r=e/2,s=new Image;s.onload=function(){var i=a.createPattern(s,"repeat");(function(){for(var n=r;n<t.height;n+=e)for(var s=r;s<t.width;s+=e)a.fillStyle="rgb(196, 127, 51)",a.fillRect(s-r,n-r,e,e),a.fillStyle=i,a.fillRect(s-r,n-r,e,e),a.beginPath(),a.fillStyle="black",a.arc(s,n,r/20,0,2*Math.PI,!1),a.fill()}).call(n),n.onready&&n.onready()},s.src="data:image/png;base64,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"}},{key:"initialize",value:function(t,e,n){var a=this.shadowRoot.querySelector("#goban");a.width=t*e,a.height=t*n,this.drawGround(a,t);var r=this.shadowRoot.querySelector("#leaves");r.setAttribute("width","".concat(a.width,"px")),r.setAttribute("height","".concat(a.height,"px"));for(var s=.0036*t,i=1;i<=n;i++)for(var o=1;o<=e;o++){var l=document.createElementNS("http://www.w3.org/2000/svg","use");l.id="leaf-".concat(o-1+(i-1)*e),l.setAttributeNS("http://www.w3.org/1999/xlink","href","#four-leaves"),l.setAttribute("transform","translate(".concat(o*t-t/2,",").concat(i*t-t/2,") scale(").concat(s,")")),l.setAttribute("display","none"),l.classList.add("four-leaves"),r.appendChild(l)}var c=this.shadowRoot.querySelector("#territory");c.setAttribute("width","".concat(a.width,"px")),c.setAttribute("height","".concat(a.height,"px"));for(var u=1;u<=n;u++)for(var h=1;h<=e;h++){var d=document.createElementNS("http://www.w3.org/2000/svg","use");d.id="territory-".concat(h-1+(u-1)*e),d.setAttributeNS("http://www.w3.org/1999/xlink","href","#seedlings"),d.setAttribute("transform","translate(".concat(h*t-2*t/3,",").concat(u*t-2*t/3,") scale(").concat(s,")")),d.setAttribute("display","none"),d.classList.add("territory"),c.appendChild(d)}var f=this.shadowRoot.querySelector("#bans");f.width=a.width,f.height=a.height,this.alleloBoard=new L(t,e,n,this.shadowRoot)}},{key:"setBans",value:function(t){var e=this.shadowRoot.querySelector("#bans"),n=e.width/parseInt(this.dataset.width),a=e.getContext("2d");a.clearRect(0,0,e.width,e.height);var r,s=this.shadowRoot.querySelector(".container").style.backgroundColor,i=Object(h.a)(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;a.fillStyle=s,a.fillRect((o[0]-1)*n,(o[1]-1)*n,n,n)}}catch(l){i.e(l)}finally{i.f()}}}],[{key:"observedAttributes",get:function(){return["data-stone-size","data-width","data-height"]}}]),n})(Object(x.a)(HTMLElement)).init();var F=function(t){Object(v.a)(n,t);var e=Object(m.a)(n);function n(t){var a;return Object(d.a)(this,n),(a=e.call(this,t)).boardRef=void 0,a.boardRef=r.a.createRef(),a.state={animation:!1},a}return Object(f.a)(n,[{key:"render",value:function(){return r.a.createElement("allelo-board",{ref:this.boardRef,"data-stone-size":"100","data-width":this.props.position.WIDTH,"data-height":this.props.position.HEIGHT})}},{key:"componentDidMount",value:function(){var t,e,n,a=this;null===(t=this.boardRef)||void 0===t||null===(e=t.current)||void 0===e||null===(n=e.alleloBoard)||void 0===n||n.addEventListener("click",(function(t,e){a.onClick(t,e)}))}},{key:"componentWillUnmount",value:function(){var t,e,n;null===(t=this.boardRef)||void 0===t||null===(e=t.current)||void 0===e||null===(n=e.alleloBoard)||void 0===n||n.removeEventListener("click",void 0)}},{key:"onClick",value:function(t,e){this.state.animation||this.props.onClick(t,e)}},{key:"play",value:function(){var t=Object(c.a)(l.a.mark((function t(e,n,a,r){var s,i,o,c,u,h;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.state.animation){t.next=2;break}return t.abrupt("return");case 2:this.setState({animation:!0}),c=e.xyToPoint(n,a),u=new Float32Array(e.LENGTH),h=0;case 6:if(!(h<u.length)){t.next=18;break}t.t0=e.getState(h),t.next=1===t.t0?10:2===t.t0?12:14;break;case 10:return u[h]=1,t.abrupt("break",15);case 12:return u[h]=-1,t.abrupt("break",15);case 14:u[h]=0;case 15:h++,t.next=6;break;case 18:return t.next=20,null===(s=this.boardRef)||void 0===s||null===(i=s.current)||void 0===i||null===(o=i.alleloBoard)||void 0===o?void 0:o.drawStone(u,1===r.turn?1:-1,c,r.captives);case 20:this.setState({animation:!1});case 21:case"end":return t.stop()}}),t,this)})));return function(e,n,a,r){return t.apply(this,arguments)}}()},{key:"clear",value:function(){var t=Object(c.a)(l.a.mark((function t(){var e,n,a,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=new Float32Array(this.props.position.WIDTH*this.props.position.HEIGHT),t.next=3,null===(e=this.boardRef)||void 0===e||null===(n=e.current)||void 0===n||null===(a=n.alleloBoard)||void 0===a?void 0:a.drawStone(r,1,null);case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),n}(r.a.Component),P=function(){function t(){var e=this;Object(d.a)(this,t),this.inputDom=document.getElementById("input"),this.outputDom=document.getElementById("output"),this.outputDom.addEventListener("message",(function(t){e.process(t.currentTarget.value),t.currentTarget.value=""}),!1)}return Object(f.a)(t,[{key:"_command",value:function(t){this.inputDom.command.value=t,this.inputDom.dispatchEvent(new CustomEvent("submit"))}},{key:"command",value:function(t){var e=this;return new Promise((function(n,a){null==e.inputDom.command.getAttribute("disabled")&&(e.LzAnalyzeHandler=null,e.resolve=n,e.reject=a,e._command(t))}))}},{key:"lzAnalyze",value:function(t,e){null==this.inputDom.command.getAttribute("disabled")&&(this.LzAnalyzeHandler=e,this._command("lz-analyze ".concat(t)))}},{key:"kataAnalyze",value:function(t,e){null==this.inputDom.command.getAttribute("disabled")&&(this.kataAnalyzeHandler=e,this._command("kata-analyze ".concat(t," ownership true")))}},{key:"process",value:function(t){t.startsWith("=")?this.resolve&&(this.resolve(t),this.resolve=null):t.startsWith("?")&&this.reject&&(this.reject(t),this.reject=null),this.LzAnalyzeHandler&&this.parseLzAnalyze(t),this.kataAnalyzeHandler&&this.parseKataAnalyze(t)}},{key:"parseLzAnalyze",value:function(t){for(var e,n=/info move ([A-Z]\d{1,2}) visits (\d+) winrate (\d+) prior (-?\d+) lcb (-?\d+) order (\d+) pv ((:? ?[A-Z]\d{1,2})+)/g,a=[];null!=(e=n.exec(t));)a.push({move:e[1],visits:parseInt(e[2]),winrate:parseInt(e[3])/1e4,prior:parseInt(e[4]),lcb:parseInt(e[5]),orer:parseInt(e[6]),pv:e[7].split(" ")});this.LzAnalyzeHandler(a)}},{key:"parseKataAnalyze",value:function(t){for(var e,n=/info move ([A-Z]\d{1,2}) visits (\d+) utility (-?\d+\.\d+(?:e-?\d+)?) radius (-?\d+\.\d+(?:e-?\d+)?) winrate (-?\d+\.\d+(?:e-?\d+)?) scoreMean (-?\d+\.\d+(?:e-?\d+)?) scoreStdev (-?\d+\.\d+(?:e-?\d+)?) prior (-?\d+\.\d+(?:e-?\d+)?) lcb (-?\d+\.\d+(?:e-?\d+)?) utilityLcb (-?\d+\.\d+(?:e-?\d+)?) order (-?\d+) pv ((?: ?[A-Z]\d{1,2})+)/g,a={info:[],ownership:[]};null!=(e=n.exec(t));)a.info.push({move:e[1],visits:parseInt(e[2]),utility:parseFloat(e[3]),radius:parseFloat(e[4]),winrate:parseFloat(e[5]),scoreMean:parseFloat(e[6]),scoreStdev:parseFloat(e[7]),prior:parseFloat(e[8]),lcb:parseFloat(e[9]),utilibyLcb:parseFloat(e[10]),order:parseInt(e[11]),pv:e[12].split(" ")});null!=(e=t.match(/ownership((?: -?\d+\.\d+(?:e-?\d+)?)+)/))&&(a.ownership=e[1].trim().split(" ")),this.kataAnalyzeHandler(a)}}]),t}();P.shared=new P;var N=P,q=function(t){Object(v.a)(n,t);var e=Object(m.a)(n);function n(t){var a;return Object(d.a)(this,n),(a=e.call(this,t)).size=void 0,a.byoyomi=void 0,a.model=void 0,a.gtp=void 0,a.boardRef=void 0,a.modalRef=void 0,a.handicap=void 0,a.yourTurn=void 0,a.boardRef=r.a.createRef(),a.size=7,a.byoyomi=3,a.handicap=5,a.yourTurn=1,a.model=new I(a.size,a.size),a.state={percent:50,black:"",white:"",turn:1,candidates:[],ownership:[],modalIsOpen:!1,modalStyle:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"}},modalMessage:"\u3053\u3093\u306b\u3061\u306f\uff01\u3059\u3053\u3057 \u307e\u3063\u3066\u306d",buttonMessage:"\u3068\u3058\u308b"},a.gtp=N.shared,a.closeModal=a.closeModal.bind(Object(p.a)(a)),a.modalRef=r.a.createRef(),a}return Object(f.a)(n,[{key:"render",value:function(){var t,e=this,n=[],a=Object(h.a)(this.state.modalMessage.split("\n").entries());try{for(a.s();!(t=a.n()).done;){var s=Object(u.a)(t.value,2),i=s[0],o=s[1];n.push(r.a.createElement("p",{key:"gbc-p-".concat(i)},o))}}catch(d){a.e(d)}finally{a.f()}return r.a.createElement("div",null,r.a.createElement("p",{className:"align-center"},this.state.turn===this.yourTurn?"\u3042\u306a\u305f\u306e\u3070\u3093":"\u308f\u305f\u3057\u306e\u3070\u3093"),r.a.createElement(F,{ref:this.boardRef,position:this.model,onClick:function(){var t=Object(c.a)(l.a.mark((function t(n,a){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.onClick(n,a);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}),r.a.createElement("div",{className:"align-center"},r.a.createElement("button",{className:"button",onClick:function(){e.pass()}},"\u30d1\u30b9"),r.a.createElement("button",{className:"button",onClick:function(){e.resign()}},"\u3042\u304d\u3089\u3081\u308b")),r.a.createElement(k.a,{ref:this.modalRef,isOpen:this.state.modalIsOpen,onRequestClose:this.closeModal,style:this.state.modalStyle,contentLabel:"\u30bb\u30ea\u30d5"},r.a.createElement("h2",null,"\u3044\u3054\u306e\u305b\u3093\u305b\u3044"),n,r.a.createElement("button",{onClick:this.closeModal},this.state.buttonMessage)))}},{key:"loadWeight",value:function(){var t=Object(c.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.gtp.command("time_settings 0 1 1");case 2:return t.next=4,this.gtp.command("genmove black");case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"setRule",value:function(){var t=Object(c.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.gtp.command("komi 0");case 2:return t.next=4,this.gtp.command("time_settings 0 ".concat(this.byoyomi," 1"));case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"resetBoard",value:function(){var t=Object(c.a)(l.a.mark((function t(){var e,n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.gtp.command("clear_board");case 2:return this.model.clear(),t.next=5,null===(e=this.boardRef)||void 0===e||null===(n=e.current)||void 0===n?void 0:n.clear();case 5:this.setState({turn:this.model.turn});case 6:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"startGame",value:function(){var t=Object(c.a)(l.a.mark((function t(){var e,n,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this.handicap>=2)){t.next=23;break}e=0;case 2:if(!(e<this.handicap)){t.next=21;break}case 3:return t.prev=3,this.model.turn=1,n=g(this.model.WIDTH)+1,a=g(this.model.HEIGHT)+1,t.next=9,this.gtp.command("play black ".concat(T(n,a)));case 9:return t.next=11,this.play(n,a);case 11:return t.abrupt("break",18);case 14:t.prev=14,t.t0=t.catch(3);case 16:t.next=3;break;case 18:e++,t.next=2;break;case 21:return t.next=23,this.enginePlay();case 23:case"end":return t.stop()}}),t,this,[[3,14]])})));return function(){return t.apply(this,arguments)}}()},{key:"onClick",value:function(){var t=Object(c.a)(l.a.mark((function t(e,n){var a,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((a=this.model.turn)===this.yourTurn){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,this.play(e,n);case 5:if(null!=(r=t.sent)){t.next=8;break}return t.abrupt("return");case 8:if(t.prev=8,1===r.captives.length&&r.captives[0]===r.point){t.next=12;break}return t.next=12,this.gtp.command("play ".concat(1===a?"black":"white"," ").concat(T(e,n)));case 12:return t.next=14,this.enginePlay();case 14:t.next=19;break;case 16:t.prev=16,t.t0=t.catch(8),console.log(t.t0,r);case 19:case"end":return t.stop()}}),t,this,[[8,16]])})));return function(e,n){return t.apply(this,arguments)}}()},{key:"enginePlay",value:function(){var t=Object(c.a)(l.a.mark((function t(){var e,n,a,r,s=this;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.model.turn,t.next=3,this.gtp.command("genmove ".concat(1===e?"black":"white"));case 3:if("= resign"!==(n=t.sent)){t.next=9;break}return t.next=7,new Promise((function(t,e){s.setState((function(t,e){var n="\u3042\u304d\u3089\u3081\u307e\u3059\u3002\u307e\u3051\u307e\u3057\u305f\u3002";return s.handicap>1?s.handicap-=1:n+="\n\u3064\u3088\u3044\uff01\u3082\u3046\u304a\u3057\u3048\u308b\u3053\u3068\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\u3053\u306e\u3061\u3087\u3046\u3057\u3067\u3001\u3044\u3054\u306e\u307f\u3061\u3092\u307e\u3044\u3057\u3093\u3057\u3066\u304f\u3060\u3055\u3044\uff01",{modalIsOpen:!0,modalMessage:n+"\n\u3082\u30461\u30b2\u30fc\u30e0\u3057\u307e\u3059\u304b\uff1f",buttonMessage:"\u306f\u3044"}}))}));case 7:t.next=25;break;case 9:if("= pass"!==n){t.next=20;break}if(this.model.play(-1),this.setState({turn:this.model.turn}),!(this.model.passes<2)){t.next=16;break}this.setState((function(t,e){return{modalIsOpen:!0,modalMessage:"\u30d1\u30b9\u3057\u307e\u3059\n(\u304b\u3089\u3059\u3053\u3068\u304c\u3067\u304d\u308b \u304d\u307f\u3069\u308a\u306f \u305c\u3093\u3076 \u304b\u3089\u305b\u3066\u304f\u3060\u3055\u3044\u3002\n\u304b\u3089\u3059\u3053\u3068\u304c\u3067\u304d\u308b \u304d\u307f\u3069\u308a\u304c\u306a\u304f\u306a\u3063\u305f\u3089 \u30d1\u30b9\u3057\u3066\u304f\u3060\u3055\u3044)",buttonMessage:"\u3068\u3058\u308b"}})),t.next=18;break;case 16:return t.next=18,this.makeScore();case 18:t.next=25;break;case 20:if(!(a=n.match(/^= ([A-Z][0-9]{1,2})/))){t.next=25;break}return r=S(a[1]),t.next=25,this.play(r[0],r[1]);case 25:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"play",value:function(){var t=Object(c.a)(l.a.mark((function t(e,n){var a,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null==(a=this.model.play(this.model.xyToPoint(e,n)))){t.next=7;break}return t.next=4,null===(r=this.boardRef.current)||void 0===r?void 0:r.play(this.model,e,n,a);case 4:return this.setState({turn:this.model.turn}),t.next=7,b(0);case 7:return t.abrupt("return",a);case 8:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"pass",value:function(){var t=Object(c.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.model.turn!==this.yourTurn){t.next=11;break}if(this.model.play(-1),!(this.model.passes<2)){t.next=8;break}return this.setState({turn:this.model.turn}),t.next=6,this.enginePlay();case 6:t.next=11;break;case 8:return this.setState({modalIsOpen:!0,modalMessage:"\u304a\u305f\u304c\u3044\u306e\u304b\u305a\u3092\u3051\u3044\u3055\u3093\u3057\u307e\u3059\n\u3061\u3087\u3063\u3068\u307e\u3063\u3066\u306d",buttonMessage:"\u3068\u3058\u308b"}),t.next=11,this.makeScore();case 11:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"resign",value:function(){var t=Object(c.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.model.turn===this.yourTurn&&(this.handicap+=1,this.setState({modalIsOpen:!0,modalMessage:"\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3057\u305f\n\u3082\u30461\u30b2\u30fc\u30e0\u3057\u307e\u3059\u304b\uff1f",buttonMessage:"\u306f\u3044"}));case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"closeModal",value:function(){var t=Object(c.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.setState({modalIsOpen:!1}),"\u306f\u3044"!==this.state.buttonMessage){t.next=6;break}return t.next=4,this.resetBoard();case 4:return t.next=6,this.startGame();case 6:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"makeScore",value:function(){var t=Object(c.a)(l.a.mark((function t(){var e,n,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.gtp.command("final_score");case 2:if(e=t.sent,n="","= 0"!==e){t.next=8;break}n="\u3072\u304d\u308f\u3051\u3067\u3059\u306d",t.next=14;break;case 8:if(!(a=e.match(/^= (B|W)\+([0-9]+)/))){t.next=13;break}a[1]===(1===this.yourTurn?"B":"W")?(n="\u3042\u306a\u305f\u306e ".concat(a[2],"\u3064 \u304b\u3061\u3067\u3059\u304b\uff1f\n\u307e\u3051\u307e\u3057\u305f\u3002\u3064\u3088\u3044\u3067\u3059\u306d"),this.handicap>0&&(this.handicap-=1)):(n="\u308f\u305f\u3057\u306e ".concat(a[2],"\u3064 \u304b\u3061\u3067\u3059\u304b"),this.handicap+=1),t.next=14;break;case 13:throw new Error("should not reach here");case 14:this.setState({modalIsOpen:!0,modalMessage:n+"\n\u3082\u30461\u30b2\u30fc\u30e0\u3057\u307e\u3059\u304b\uff1f",buttonMessage:"\u306f\u3044"});case 15:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),n}(a.Component);k.a.setAppElement("#app-container");var _=function(t){Object(v.a)(n,t);var e=Object(m.a)(n);function n(t){var a;return Object(d.a)(this,n),(a=e.call(this,t)).controllerRef=void 0,a.modalRef=void 0,a.controllerRef=r.a.createRef(),a.modalRef=r.a.createRef(),a.state={isLoading:!0,modalIsOpen:!0,modalMessage:"\u3053\u3093\u306b\u3061\u306f\uff01\u3059\u3053\u3057 \u307e\u3063\u3066\u306d",modalStyle:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"}}},a.start=a.start.bind(Object(p.a)(a)),window.controller=Object(p.a)(a),a}return Object(f.a)(n,[{key:"render",value:function(){var t,e=[],n=Object(h.a)(this.state.modalMessage.split("\n").entries());try{for(n.s();!(t=n.n()).done;){var a=Object(u.a)(t.value,2),s=a[0],i=a[1];e.push(r.a.createElement("p",{key:"app-p-".concat(s)},i))}}catch(o){n.e(o)}finally{n.f()}return r.a.createElement("div",{className:"container"},r.a.createElement("p",null,"\u30eb\u30fc\u30eb"),e,r.a.createElement(q,{ref:this.controllerRef}),r.a.createElement("small",null,"\u52b9\u679c\u97f3\u306b",r.a.createElement("a",{href:"https://taira-komori.jpn.org/index.html"},"\u7121\u6599\u52b9\u679c\u97f3\u3067\u904a\u307c\u3046\uff01"),"\u69d8\u306e\u7d20\u6750\u3092\u5229\u7528\u3055\u305b\u3066\u3044\u305f\u3060\u3044\u3066\u3044\u307e\u3059"),r.a.createElement(k.a,{ref:this.modalRef,isOpen:this.state.modalIsOpen,style:this.state.modalStyle,contentLabel:"\u3042\u3044\u3055\u3064\u3068\u30eb\u30fc\u30eb"},r.a.createElement("h2",null,"\u3044\u3054\u306e\u305b\u3093\u305b\u3044"),e,this.state.isLoading?void 0:r.a.createElement("button",{onClick:this.start},"\u306f\u3058\u3081\u308b")))}},{key:"onReady",value:function(){var t=this;setTimeout(Object(c.a)(l.a.mark((function e(){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(n=t.controllerRef.current)||void 0===n?void 0:n.loadWeight();case 2:t.setState({isLoading:!1,modalMessage:"\u307f\u3069\u308a\u3092\u3075\u3084\u3059\u30b2\u30fc\u30e0\u3092\u3057\u307e\u3057\u3087\u3046\n\u3042\u306a\u305f\u306f\u3053\u3044\u307f\u3069\u308a\u3001\u308f\u305f\u3057\u306f\u304d\u307f\u3069\u308a\u3067\u3059\n\u306f\u305f\u3051\u306e\u306a\u304b\u306b\u305f\u304f\u3055\u3093 \u307f\u3069\u308a\u3092\u3075\u3084\u3057\u305f\u307b\u3046\u304c\u304b\u3061\u3067\u3059\n\u306f\u3063\u3071\u3092\u305c\u3093\u3076\u304b\u304f\u3055\u308c\u308b\u3068 \u304b\u308c\u307e\u3059\n\u3067\u306f\u3001\u3084\u3063\u3066\u307f\u307e\u3057\u3087\u3046"});case 3:case"end":return e.stop()}}),e)}))),0)}},{key:"start",value:function(){var t=Object(c.a)(l.a.mark((function t(){var e,n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.closeModal(),t.next=3,null===(e=this.controllerRef.current)||void 0===e?void 0:e.setRule();case 3:return t.next=5,null===(n=this.controllerRef.current)||void 0===n?void 0:n.startGame();case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"closeModal",value:function(){this.setState({modalIsOpen:!1})}}]),n}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));"undefined"!==typeof SharedArrayBuffer&&i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(_,null)),document.getElementById("app-container")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[24,1,2]]]);
//# sourceMappingURL=main.d03ea2e3.chunk.js.map