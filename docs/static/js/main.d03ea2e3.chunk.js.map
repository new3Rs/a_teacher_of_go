{"version":3,"sources":["utilities.ts","GoPosition.ts","waudio.js","allelo-board.js","AlleloBoard.tsx","Gtp.js","GoBoardController.tsx","App.tsx","serviceWorker.js","index.js"],"names":["random","n","Math","floor","sleep","a","Promise","res","rej","setTimeout","coord2xy","coord","c","charCodeAt","parseInt","slice","xy2coord","x","y","opponentOf","color","Marker","size","value","marks","this","Int32Array","point","GoPosition","width","height","WIDTH","HEIGHT","LENGTH","marker1","marker2","state","turn","ko","passes","Uint8Array","source","result","set","sgf","jssgf","fastParse","root","SZ","test","match","p","node","_children","length","move","B","W","play","xyToPoint","apply","moveToXy","string","points","e","setState","opponent","captives","adjacenciesAt","pt","getState","stringAt","liberties","removeString","push","GoString","clear","mark","index","isMarked","opponents","empties","GoConnectedEmpties","blacks","whites","switchTurn","GoPlayMove","captureBy","Error","includes","undoPlay","OFFSET","xy","pointToXy","WAudio","src","forcePlay","constructor","NO_SOURCE","sources","LOADING","LOADED","window","AudioContext","context","webkitAudioContext","addEventListener","once","unlock","removeEventListener","resume","createBufferSource","buffer","createBuffer","connect","destination","onended","disconnect","start","noteOn","stop","noteOff","options","xhr","XMLHttpRequest","open","responseType","onload","decodeAudioData","response","console","log","send","load","gain","panner","volume","createGain","pan","createPanner","panningModel","z","setPosition","sin","PI","splice","indexOf","forEach","initClass","playMoveSound1","playMoveSound2","capturedSound","compileShader","gl","elem","boardWidth","boardHeight","shaderType","type","VERTEX_SHADER","FRAGMENT_SHADER","shader","createShader","shaderSource","text","replace","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","AlleloBoard","stoneSize","shadowRoot","drawing","listeners","goban","querySelector","territory","stones","getAttribute","setAttribute","getContext","vertexShader","getElementById","fragmentShader","program","createProgram","attachShader","linkProgram","useProgram","vertexData","Float32Array","vertexDataBuffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","positionHandle","name","attributeLocation","getAttribLocation","enableVertexAttribArray","vertexAttribPointer","FLOAT","FALSE","stonesHandle","uniformLocation","getUniformLocation","leaves","clickHandler","prototype","bind","deleteProgram","deleteShader","boardState","addIndex","removeIndices","INTERVAL","b","opponentColor","Date","now","grow","dataToSendToGPU","interval","addStone","min","i","uniform1fv","drawArrays","TRIANGLE_STRIP","requestAnimationFrame","updateLeaves","updateTerritory","decline","removedStone","max","error","leaf","removeAttribute","position","emptiesArray","j","find","connectedEmptiesAt","handler","array","element","removeElement","event","rect","currentTarget","getBoundingClientRect","clientX","left","offsetWidth","clientY","top","offsetHeight","click","attachShadow","mode","instance","template","content","cloneNode","appendChild","dataset","initialize","parseFloat","defs","document","createElementNS","setAttributeNS","innerHTML","body","createElement","id","customElements","define","oldvalue","newValue","alleloBoard","ctx","lineWidth","strokeStyle","halfSize","groundImage","Image","groundPattern","createPattern","fillStyle","fillRect","beginPath","arc","fill","call","onready","drawGround","scale","fourLeaves","classList","add","karakusa","bans","canvas","clearRect","background","style","backgroundColor","ban","HTMLElement","init","props","boardRef","React","createRef","animation","ref","data-stone-size","data-width","data-height","current","onClick","undefined","drawStone","Component","Gtp","inputDom","outputDom","process","str","command","dispatchEvent","CustomEvent","LzAnalyzeHandler","resolve","reject","_command","kataAnalyzeHandler","line","startsWith","parseLzAnalyze","parseKataAnalyze","regex","exec","visits","winrate","prior","lcb","orer","pv","split","info","ownership","utility","radius","scoreMean","scoreStdev","utilibyLcb","order","trim","shared","GoBoardController","byoyomi","model","gtp","modalRef","handicap","yourTurn","percent","black","white","candidates","modalIsOpen","modalStyle","right","bottom","marginRight","transform","modalMessage","buttonMessage","closeModal","paragraphs","entries","m","key","className","pass","resign","isOpen","onRequestClose","contentLabel","enginePlay","message","makeScore","resetBoard","startGame","Modal","setAppElement","App","controllerRef","isLoading","controller","href","loadWeight","setRule","Boolean","location","hostname","SharedArrayBuffer","ReactDOM","render","StrictMode","navigator","serviceWorker","ready","then","registration","unregister","catch"],"mappings":"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","file":"static/js/main.d03ea2e3.chunk.js","sourcesContent":["/**\n * @preserve Copyright 2020 ICHIKAWA, Yuji (New 3 Rs)\n */\n\n export function random(n: number) {\n    return Math.floor(Math.random() * n);\n}\n\nexport async function sleep(n: number): Promise<void> {\n    return new Promise(function(res, rej) {\n        setTimeout(res, n);\n    });\n}\n\n","/**\n * @preserve Copyright 2020 ICHIKAWA, Yuji (New 3 Rs)\n */\nimport jssgf from \"jssgf\";\n\nexport const PASS = -1;\nexport const EMPTY = 0;\nexport const BLACK = 1;\nexport const WHITE = 2;\nexport const BAN = 3;\n\n\nexport function coord2xy(coord: string): [number, number] {\n    const c = coord.charCodeAt(0);\n    const x = (c < \"I\".charCodeAt(0) ? c + 1 : c) - \"A\".charCodeAt(0);\n    return [x, parseInt(coord.slice(1))];\n}\n\nexport function xy2coord(x: number, y: number): string {\n    const COORD = [\"@\", \"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"J\", \"K\", \"L\", \"M\", \"N\", \"O\", \"P\", \"Q\", \"R\", \"S\", \"T\"];\n    return COORD[x] + y;\n}\n\n/**\n * 相手のカラーを返す。\n * @param {Integer} color \n * @returns {Integer}\n */\nfunction opponentOf(color: number): number {\n    switch (color) {\n        case BLACK:\n            return WHITE;\n        case WHITE:\n            return BLACK;\n        default:\n            return EMPTY;\n    }\n}\n\n/** 盤上を再帰的に処理するときに処理済みかチェックするためのヘルパークラス */\nclass Marker {\n    value: number;\n    marks: Int32Array;\n    \n    constructor(size: number) {\n        this.value = 0;\n        this.marks = new Int32Array(size);\n    }\n\n    clear() {\n        this.value += 1;\n    }\n\n    isMarked(point: number): boolean {\n        return this.marks[point] === this.value;\n    }\n\n    mark(point: number) {\n        this.marks[point] = this.value;\n    }\n}\n\nexport class GoPosition {\n    WIDTH: number;\n    HEIGHT: number;\n    LENGTH: number;\n    marker1: Marker;\n    marker2: Marker;\n    state: Uint8Array;\n    turn: number;\n    ko: number | null;\n    passes: number;\n\n    static copy(source: GoPosition): GoPosition {\n        const result = new GoPosition(source.WIDTH, source.HEIGHT);\n        result.state.set(source.state);\n        result.turn = source.turn;\n        result.ko = source.ko;\n        result.passes = source.passes;\n        return result;\n    }\n\n    static fromSgf(sgf: string): GoPosition {\n        const [root] = jssgf.fastParse(sgf);\n        let width = 19;\n        let height = 19;\n        if (root.SZ) {\n            if (/^[0-9]{1,2}$/.test(root.SZ)) {\n                width = parseInt(root.SZ);\n                height = width;\n            } else {\n                const match = root.SZ.match(/^([0-9]{1,2}):([0-9]{1,2})$/);\n                if (match) {\n                    width = parseInt(match[1]);\n                    height = parseInt(match[2]);\n                }\n            }\n        }\n        const p = new this(width, height);\n        let node = root;\n        while (node._children.length > 0) {\n            node = node._children[0];\n            let move;\n            if (node.B != null) {\n                move = node.B;\n            } else if (node.W != null) {\n                move = node.W;\n            } else {\n                continue;\n            }\n            p.play(p.xyToPoint.apply(p, p.moveToXy(move)));\n        }\n        return p\n    }\n\n    constructor(width: number, height: number) {\n        this.WIDTH = width;\n        this.HEIGHT = height;\n        this.LENGTH = this.WIDTH * this.HEIGHT;\n        this.state = new Uint8Array(this.LENGTH);\n        this.turn = BLACK;\n        this.marker1 = new Marker(this.LENGTH);\n        this.marker2 = new Marker(this.LENGTH);\n        this.ko = null;\n        this.passes = 0;\n    }\n\n    clear() {\n        this.state = new Uint8Array(this.LENGTH);\n        this.turn = BLACK;\n        this.ko = null;\n        this.passes = 0;\n    }\n\n    opponent(): number {\n        return opponentOf(this.turn);\n    }\n\n    switchTurn() {\n        this.turn = opponentOf(this.turn);\n    }\n\n    getState(point: number): number {\n        return this.state[point];\n    }\n\n    setState(point: number, color: number) {\n        this.state[point] = color;\n    }\n\n    removeString(string: GoString) {\n        for (const e of string.points) {\n            this.setState(e, EMPTY);\n        }\n    }\n\n    captureBy(point: number): number[] {\n        const opponent = this.opponent();\n        const captives: number[] = [];\n        for (const pt of this.adjacenciesAt(point)) {\n            if (this.getState(pt) === opponent) {\n                const string = this.stringAt(pt);\n                if (string && string.liberties.length === 0) {\n                    this.removeString(string);\n                    captives.push.apply(captives, string.points);\n                }\n            }\n        }\n        return captives;\n    }\n\n    stringAt(point: number): GoString | null {\n        const color = this.getState(point);\n        if (color === EMPTY || color === BAN) {\n            return null;\n        }\n        const opponent = opponentOf(color);\n        const string = new GoString();\n\n        this.marker1.clear();\n        this.marker2.clear();\n        string.points.push(point);\n        this.marker2.mark(point);\n        for (let index = 0; index < string.points.length; index++) {\n            const pt = string.points[index];\n            if (!this.marker1.isMarked(pt)) {\n                this.marker1.mark(pt);\n                for (const a of this.adjacenciesAt(pt)) {\n                    if (!this.marker1.isMarked(a)) {\n                        const state = this.getState(a);\n                        if (state === color) {\n                            if (!this.marker2.isMarked(a)) {\n                                string.points.push(a);\n                                this.marker2.mark(a);\n                            }\n                        } else {\n                            this.marker1.mark(a);\n                            if (state === opponent) {\n                                string.opponents.push(a);\n                            } else if (state === EMPTY) {\n                                string.liberties.push(a);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        return string;\n    }\n\n    connectedEmptiesAt(point: number): GoConnectedEmpties | null {\n        if (this.getState(point) !== EMPTY) {\n            return null;\n        }\n        const empties = new GoConnectedEmpties();\n\n        this.marker1.clear();\n        this.marker2.clear();\n        empties.points.push(point);\n        this.marker2.mark(point);\n        for (let index = 0; index < empties.points.length; index++) {\n            const pt = empties.points[index];\n            if (!this.marker1.isMarked(pt)) {\n                this.marker1.mark(pt);\n                for (const a of this.adjacenciesAt(pt)) {\n                    if (!this.marker1.isMarked(a)) {\n                        const state = this.getState(a);\n                        if (state === EMPTY) {\n                            if (!this.marker2.isMarked(a)) {\n                                empties.points.push(a);\n                                this.marker2.mark(a);\n                            }\n                        } else {\n                            this.marker1.mark(a);\n                            if (state === BLACK) {\n                                empties.blacks.push(a);\n                            } else if (state === WHITE) {\n                                empties.whites.push(a);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        return empties;\n    }\n\n    play(point: number): GoPlayMove | null {\n        const turn = this.turn;\n        const ko = this.ko;\n        if (point === PASS) {\n            this.passes += 1;\n            this.ko = null;\n            this.switchTurn();\n            return new GoPlayMove(turn, point, ko, [], null);\n        } else if (this.getState(point) !== EMPTY) { // 着手禁止\n            return null;\n        }\n        this.passes = 0;\n        if (point === ko) {\n            this.ko = null;\n            this.switchTurn();\n            return new GoPlayMove(turn, point, ko, [point], null);\n        }\n        this.setState(point, this.turn);\n        const captives = this.captureBy(point);\n        const string = this.stringAt(point);\n        if (string == null) {\n            throw new Error(\"should not reach here\");\n        }\n        const liberties = string.liberties.length;\n        if (captives.length === 1 && liberties === 1 && string.points.length === 1) {\n            this.ko = string.liberties[0];\n        } else {\n            this.ko = null;\n        }\n        this.switchTurn();\n        if (liberties === 0) {\n            for (const e of string.points) {\n                this.setState(e, EMPTY);\n            }\n            return new GoPlayMove(turn, point, ko, string.points, null);\n        } else {\n            return new GoPlayMove(turn, point, ko, captives, string);\n        }\n    }\n\n    undoPlay(move: GoPlayMove) {\n        this.ko = move.ko;\n        this.switchTurn();\n        if (move.point === PASS) {\n            return;\n        }\n        if (move.captives.includes(move.point)) {\n            for (const p of move.captives) {\n                this.setState(p, move.turn);\n            }\n        } else {\n            const opponent = opponentOf(move.turn);\n            for (const p of move.captives) {\n                this.setState(p, opponent);\n            }\n        }\n        this.setState(move.point, EMPTY);\n    }\n\n    isLegal(point: number): boolean {\n        const move = this.play(point);\n        if (move) {\n            this.undoPlay(move);\n            return true;\n        }\n        return false;\n    }\n\n    xyToPoint(x: number, y: number): number {\n        return (x - 1) + (y - 1) * this.WIDTH;\n    }\n\n    pointToXy(point: number): [number, number] {\n        const y = Math.floor(point / this.WIDTH);\n        const x = point - y * this.WIDTH;\n        return [x + 1, y + 1];\n    }\n\n    moveToXy(move: string): [number, number] {\n        const OFFSET = \"a\".charCodeAt(0) - 1;\n        return [move.charCodeAt(0) - OFFSET, move.charCodeAt(1) - OFFSET];\n    }\n\n    adjacenciesAt(point: number): number[] {\n        const xy = this.pointToXy(point);\n        const result = [];\n        for (const e of [[0, -1], [-1, 0], [1, 0], [0, 1]]) {\n            const x = xy[0] + e[0];\n            const y = xy[1] + e[1];\n            if (x >= 1 && x <= this.WIDTH && y >= 1 && y <= this.HEIGHT) {\n                result.push(this.xyToPoint(x, y));\n            }\n        }\n        return result;\n    }\n\n    diagonalsAt(point: number): number[] {\n        const xy = this.pointToXy(point);\n        const result = [];\n        for (const e of [[-1, -1], [-1, 1], [1, -1], [1, -1]]) {\n            const x = xy[0] + e[0];\n            const y = xy[1] + e[1];\n            if (x >= 1 && x <= this.WIDTH && y >= 1 && y <= this.HEIGHT) {\n                result.push(this.xyToPoint(x, y));\n            }\n        }\n        return result;\n    }\n\n    toString() {\n        let string ='';\n        for (let y = 1; y <= this.HEIGHT; y++) {\n            for (let x = 1; x <= this.WIDTH; x++) {\n                switch (this.getState(this.xyToPoint(x, y))) {\n                    case BAN:\n                        string += '#';\n                        break;\n                    case EMPTY:\n                        string += '.';\n                        break;\n                    case BLACK:\n                        string += 'X';\n                        break;\n                    case WHITE:\n                        string += 'O';\n                        break;\n                    default:\n                }\n            }\n            string += '\\n';\n        }\n        return string;\n    }\n}\n\nclass GoString {\n    points: number[];\n    liberties: number[];\n    opponents: number[];\n\n    constructor() {\n        this.points = [];\n        this.liberties = [];\n        this.opponents = [];\n    }\n}\n\nclass GoConnectedEmpties {\n    points: number[];\n    blacks: number[];\n    whites: number[];\n\n    constructor() {\n        this.points = [];\n        this.blacks = [];\n        this.whites = [];\n    }\n}\n\nexport class GoPlayMove {\n    turn: number;\n    point: number;\n    ko: number | null;\n    captives: number[];\n    string: GoString | null;\n\n    constructor(turn: number, point: number, ko: number|null, captives: number[], string: GoString | null) {\n        this.turn = turn;\n        this.point = point;\n        this.ko = ko;\n        this.captives = captives;\n        this.string = string\n    }\n}","// (C) 2013 ICHIKAWA, Yuji (New 3 Rs)\n\nclass WAudio {\n    static initClass() {\n        this.NO_SOURCE = 0;\n        this.LOADING = 1;\n        this.LOADED = 2;\n        if (window.AudioContext) {\n            this.context = new window.AudioContext();\n        } else if (window.webkitAudioContext) {\n            this.context = new window.webkitAudioContext();\n        }\n        // モバイルブラウザは再生にユーザーインタラクションを求めるので、任意のタップで解除するようにする\n        function once() {\n            WAudio.unlock();\n            window.removeEventListener(\"click\", once);\n        }\n        window.addEventListener(\"click\", once);\n    }\n\n    static unlock() {\n        // (Chrome用)\n        if (this.context.resume) {\n            this.context.resume();\n        }\n        // (iOS用) 何かのユーザーイベントの際に呼び出し、Web Audioを有効にする。\n        // 空のソースを再生\n        const source = this.context.createBufferSource();\n        source.buffer = this.context.createBuffer(1, 1, 22050);\n        source.connect(this.context.destination);\n        source.onended = function() {\n            source.disconnect();\n        };\n        source.start = source.start || source.noteOn;\n        source.stop = source.stop || source.noteOff;\n        source.start(0);\n    }\n\n    constructor(src) {\n        this.src = src;\n        this.forcePlay = false;\n        this.state = this.constructor.NO_SOURCE;\n        this.sources = [];\n    }\n\n    load(options) {\n        const xhr = new XMLHttpRequest();\n        xhr.open('GET', this.src);\n        xhr.responseType = 'arraybuffer';\n        xhr.onload = () => {\n            return this.constructor.context.decodeAudioData(xhr.response, buffer => {\n                this.buffer = buffer;\n                this.state = this.constructor.LOADED;\n                if (this.forcePlay) {\n                    this.play(options);\n                }\n            }\n            , e => {\n                console.log(\"decodeAudioData error: \", e);\n                this.state = this.constructor.NO_SOURCE;\n            }\n            );\n        };\n        xhr.send();\n        this.state = this.constructor.LOADING;\n    }\n\n    play(options) {\n        switch (this.state) {\n            case this.constructor.NO_SOURCE:\n                this.forcePlay = true;\n                this.load(options);\n                break;\n            case this.constructor.LOADING:\n                this.forcePlay = true;\n                break;\n            case this.constructor.LOADED: {\n                const source = this.constructor.context.createBufferSource();\n                source.start = source.start || source.noteOn;\n                source.stop = source.stop || source.noteOff;\n                source.buffer = this.buffer;\n                let node = source;\n                let gain, panner;\n                if (options && options.volume != null) {\n                    gain = this.constructor.context.createGain();\n                    gain.gain.value = options.volume;\n                    node.connect(gain);\n                    node = gain;\n                }\n                if (options && options.pan != null) {\n                    panner = this.constructor.context.createPanner();\n                    panner.panningModel = 'equalpower';\n                    let z = options.pan;\n                    if (z > 90) {\n                        z = 180 - z;\n                    }\n                    panner.setPosition(Math.sin((options.pan * Math.PI) / 180), 0, Math.sin((z * Math.PI) / 180));\n                    node.connect(panner);\n                    node = panner;\n                }\n                node.connect(this.constructor.context.destination);\n                source.onended = () => {\n                    source.disconnect();\n                    if (gain) {\n                        gain.disconnect();\n                    }\n                    if (panner) {\n                        panner.disconnect();\n                    }\n                    this.sources.splice(this.sources.indexOf(source), 1);\n                };\n                source.start(0);\n                this.sources.push(source);\n                break;\n            }\n            default:\n                break;\n        }\n    }\n\n    pause() {\n        this.sources.forEach(function(source) {\n            source.stop(0);\n        });\n        this.sources = [];\n    }\n}\n\nWAudio.initClass();\n\nexport default WAudio;","/**\n * @preserve Copyright 2020 ICHIKAWA, Yuji (New 3 Rs)\n */\n\nimport { GoPosition, EMPTY, BLACK, WHITE } from \"./GoPosition\";\nimport WAudio from \"./waudio\";\n\nconst playMoveSound1 = new WAudio(\"sounds/jump01.mp3\");\nconst playMoveSound2 = new WAudio(\"sounds/jump10.mp3\");\nconst capturedSound = new WAudio(\"sounds/powerdown07.mp3\");\n\n/**\n * 配列から要素を削除する。\n * @private\n * @param {Array} array \n * @param {*} element \n */\nfunction removeElement(array, element) {\n    const index = array.indexOf(element);\n    if (index < 0) {\n        return;\n    }\n    array.splice(index, 1);\n}\n\n/**\n * シェーダをマクロ展開しコンパイルする。\n * @private\n * @param {WebGLRenderingContext} gl \n * @param {HTMLScriptElement} elem \n * @param {Number} width \n * @param {Number} height \n * @param {Integer} boardWidth \n * @param {Integer} boardHeight \n * @returns {WebGLShader}\n */\nfunction compileShader(gl, elem, width, height, boardWidth, boardHeight) {\n    let shaderType;\n    switch (elem.type) {\n        case 'x-shader/x-vertex':\n        shaderType = gl.VERTEX_SHADER;\n        break;\n        case 'x-shader/x-fragment':\n        shaderType = gl.FRAGMENT_SHADER;\n        break;\n        default:\n        return;\n    }\n    const shader = gl.createShader(shaderType);\n    gl.shaderSource(shader, elem.text\n        .replace(/%BOARD_WIDTH%/g, boardWidth)\n        .replace(/%BOARD_HEIGHT%/g, boardHeight)\n        .replace(/%WIDTH%/g, width)\n        .replace(/%HEIGHT%/g, height));\n    gl.compileShader(shader);\n\n    if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n        throw new Error(\"Shader compile failed with: \" + gl.getShaderInfoLog(shader));\n    }\n    return shader;\n}\n\n/**\n * getAttribLocationメソッドのラッパー関数。エラーを例外にする。\n * @private\n * @param {WebGLRenderingContext} gl \n * @param {WebGLProgram} program \n * @param {DOMString} name \n * @returns {GLint}\n */\nfunction getAttribLocation(gl, program, name) {\n    var attributeLocation = gl.getAttribLocation(program, name);\n    if (attributeLocation === -1) {\n        throw new Error('Can not find attribute ' + name + '.');\n    }\n    return attributeLocation;\n}\n\n/**\n * getUniformLocationメソッドのラッパー関数。エラーを例外にする。\n * @private\n * @param {WebGLRenderingContext} gl \n * @param {WebGLProgram} program \n * @param {DOMString} name \n * @returns {GLint}\n */\nfunction getUniformLocation(gl, program, name) {\n    var uniformLocation = gl.getUniformLocation(program, name);\n    if (uniformLocation === -1) {\n        throw new Error('Can not find uniform ' + name + '.');\n    }\n    return uniformLocation;\n}\n\n/** allelo-boardのヘルパークラス */\nclass AlleloBoard {\n    /**\n     * @param {Number} stoneSize\n     * @param {Integer} boardWidth \n     * @param {Integer} boardHeight \n     * @param {ShadowRoot} shadowRoot \n     */\n    constructor(stoneSize, boardWidth, boardHeight, shadowRoot) {\n        this.stoneSize = stoneSize;\n        this.boardWidth = boardWidth;\n        this.boardHeight = boardHeight;\n        this.shadowRoot = shadowRoot;\n        this.drawing = false;\n        this.listeners = {};\n        const goban = shadowRoot.querySelector('#goban');\n        this.territory = shadowRoot.querySelector('#territory');\n        this.stones = shadowRoot.querySelector('#stones');\n        const width = parseInt(goban.getAttribute('width'));\n        const height = parseInt(goban.getAttribute('height'));\n        this.territory.setAttribute('width', width);\n        this.territory.setAttribute('height', height);\n        this.stones.width = width;\n        this.stones.height = height;\n        this.gl = this.stones.getContext('webgl');\n        this.vertexShader = compileShader(this.gl, shadowRoot.getElementById('vs'), width, height, boardWidth, boardHeight);\n        this.fragmentShader = compileShader(this.gl, shadowRoot.getElementById('fs'), width, height, boardWidth, boardHeight);\n        this.program = this.gl.createProgram();\n        this.gl.attachShader(this.program, this.vertexShader);\n        this.gl.attachShader(this.program, this.fragmentShader);\n        this.gl.linkProgram(this.program);\n        this.gl.useProgram(this.program);\n        const vertexData = new Float32Array([\n            -1.0,  1.0, // top left\n            -1.0, -1.0, // bottom left\n             1.0,  1.0, // top right\n             1.0, -1.0, // bottom right\n        ]);\n        const vertexDataBuffer = this.gl.createBuffer();\n        this.gl.bindBuffer(this.gl.ARRAY_BUFFER, vertexDataBuffer);\n        this.gl.bufferData(this.gl.ARRAY_BUFFER, vertexData, this.gl.STATIC_DRAW);\n        const positionHandle = getAttribLocation(this.gl, this.program, 'position');\n        this.gl.enableVertexAttribArray(positionHandle);\n        this.gl.vertexAttribPointer(\n            positionHandle,\n            2, // position is a vec2\n            this.gl.FLOAT, // each component is a float\n            this.gl.FALSE, // don't normalize values\n            2 * 4, // two 4 byte float components per vertex\n            0 // offset into each span of vertex data\n        );\n        this.stonesHandle = getUniformLocation(this.gl, this.program, 'states');\n        this.leaves = shadowRoot.getElementById('leaves');\n        this.clickHandler = this.constructor.prototype.clickHandler.bind(this);\n        this.stones.addEventListener('click', this.clickHandler, false);\n    }\n\n    destroy() {\n        this.stones.removeEventListener('click', this.clickHandler, false);\n        this.gl.deleteProgram(this.program);\n        this.gl.deleteShader(this.fragmentShader);\n        this.gl.deleteShader(this.vertexShader);\n    }\n\n    xyToPoint(x, y) {\n        return (x - 1) + (y - 1) * this.boardWidth;\n    }\n\n    pointToXy(p) {\n        const y = Math.floor(p / this.boardWidth);\n        const x = p - y * this.boardWidth;\n        return [x + 1, y + 1];\n    }\n\n    /*\n     * indexは置いた直後の石の位置。アニメーションする\n     */\n    async drawStone(boardState, color, addIndex, removeIndices = []) {\n        this.drawing = true;\n        try {\n            const INTERVAL = 500; // ms\n            const gl = this.gl;\n            const b = boardState.slice();\n            if (removeIndices.includes(addIndex)) {\n                for (const e of removeIndices) {\n                    b[e] = color;\n                }\n            } else {\n                const opponentColor = -color;\n                for (const e of removeIndices) {\n                    b[e] = opponentColor;\n                }\n            }\n            if (addIndex != null) {\n                if (color === BLACK) {\n                    playMoveSound1.play();\n                } else {\n                    playMoveSound2.play();\n                }\n                await new Promise((res, rej) => {\n                    const start = Date.now();\n                    const grow = () => {\n                        const dataToSendToGPU = new Float32Array(b.length);\n                        const interval = Date.now() - start;\n                        const addStone = this.stoneSize / 2 * Math.min(interval / INTERVAL, 1.0);\n                        for (let i = 0; i < b.length; i++) {\n                            dataToSendToGPU[i] = b[i] * (i === addIndex ? addStone : this.stoneSize / 2);\n                        }\n                        gl.uniform1fv(this.stonesHandle, dataToSendToGPU);\n                        gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n                        if (interval <= INTERVAL) {\n                            requestAnimationFrame(grow);\n                        } else {\n                            res();\n                        }\n                    };\n                    grow();\n                });\n            } else {\n                const dataToSendToGPU = new Float32Array(b.length);\n                for (let i = 0; i < b.length; i++) {\n                    dataToSendToGPU[i] = b[i] * this.stoneSize / 2;\n                }\n                gl.uniform1fv(this.stonesHandle, dataToSendToGPU);\n                gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n            }\n            this.updateLeaves(boardState);\n            this.updateTerritory(boardState);\n            if (removeIndices.length > 0) {\n                capturedSound.play();\n                await new Promise((res, rej) => {\n                    const start = Date.now();\n                    const decline = () => {\n                        // To send the data to the GPU, we first need to\n                        // flatten our data into a single array.\n                        const dataToSendToGPU = new Float32Array(b.length);\n                        const interval = Date.now() - start;\n                        const removedStone = this.stoneSize / 2 * Math.max((INTERVAL - interval) / INTERVAL, 0.0);\n                        for (let i = 0; i < b.length; i++) {\n                            dataToSendToGPU[i] = b[i] * (removeIndices.includes(i) ? removedStone : this.stoneSize / 2);\n                        }\n                        gl.uniform1fv(this.stonesHandle, dataToSendToGPU);\n                        gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n                        if (interval <= INTERVAL) {\n                            requestAnimationFrame(decline);\n                        } else {\n                            res();\n                        }\n                    };\n                    decline();\n                });\n            }\n        } catch (e) {\n            console.error(e);\n        } finally {\n            this.drawing = false;\n        }\n    }\n\n    updateLeaves(boardState) {\n        for (let i = 0; i < this.boardWidth * this.boardHeight; i++) {\n            const leaf = this.leaves.getElementById(`leaf-${i}`);\n            if (boardState[i]) {\n                leaf.removeAttribute('display');\n                leaf.setAttribute('style', boardState[i] > 0.0 ? 'fill:#004d00;stroke:none' : 'fill:#00ff00;stroke:none');\n            } else {\n                leaf.setAttribute('display', 'none');\n            }\n        }\n    }\n\n    updateTerritory(boardState) {\n        const position = new GoPosition(this.boardWidth, this.boardHeight);\n        let stones = 0;\n        for (let y = 1; y <= this.boardHeight; y++) {\n            for (let x = 1; x <= this.boardWidth; x++) {\n                switch (boardState[this.xyToPoint(x, y)]) {\n                    case 1.0:\n                    position.setState(position.xyToPoint(x, y), BLACK);\n                    stones += 1;\n                    break;\n                    case -1.0:\n                    position.setState(position.xyToPoint(x, y), WHITE);\n                    stones += 1;\n                    break;\n                    default:\n                    position.setState(position.xyToPoint(x, y), EMPTY);\n                }\n            }\n        }\n        if (stones <= 1) { // 石を1つ置いた時他のすべてが地と見るのが正しいが、ルールを知ろうとする際には混乱すると思うので表示を抑制する\n            for (let i = 0; i < boardState.length; i++) {\n                const territory = this.territory.getElementById(`territory-${i}`);\n                territory.setAttribute('display', 'none');\n            }\n            return;\n        }\n\n        const emptiesArray = [];\n        for (let i = 0; i < boardState.length; i++) {\n            const [x, y] = this.pointToXy(i);\n            const j = position.xyToPoint(x, y);\n            const territory = this.territory.getElementById(`territory-${i}`);\n            if (position.getState(j) !== EMPTY) {\n                territory.setAttribute('display', 'none');\n                continue;\n            }\n            let empties = emptiesArray.find(e => e.points.includes(j));\n            if (empties == null) {\n                empties = position.connectedEmptiesAt(j);\n                emptiesArray.push(empties);\n            }\n            if (empties.blacks.length > 0 && empties.whites.length === 0) {\n                territory.removeAttribute('display');\n                territory.setAttribute('style', 'fill:#004d00;stroke:#004d00');\n            } else if (empties.blacks.length === 0 && empties.whites.length > 0) {\n                territory.removeAttribute('display');\n                territory.setAttribute('style', 'fill:#00ff00;stroke:#00ff00');\n            } else {\n                territory.setAttribute('display', 'none');\n            }\n        }\n    }\n\n    addEventListener(type, handler) {\n        if (!this.listeners[type]) {\n            this.listeners[type] = [];\n        }\n        this.listeners[type].push(handler);\n    }\n\n    removeEventListener(type, handler) {\n        if (!this.listeners[type]) {\n            return;\n        }\n        if (handler) {\n            removeElement(this.listeners[type], handler);\n        } else {\n            this.listeners[type] = [];\n        }\n    }\n\n    clickHandler(event) {\n        const rect = event.currentTarget.getBoundingClientRect();\n        const stones = this.shadowRoot.querySelector('#stones');\n        const x = Math.floor(this.boardWidth * (event.clientX - rect.left) / stones.offsetWidth) + 1;\n        const y = Math.floor(this.boardHeight * (event.clientY - rect.top) / stones.offsetHeight) + 1;\n        if (this.listeners.click) {\n            for (const e of this.listeners.click) {\n                e(x, y);\n            }\n        }\n    }\n}\n\nclass AlleloBoardElement extends HTMLElement {\n    static init() {\n        /*\n         * Shadow DOM内のhrefのfragmentの解決は仕様で決まっておらず、\n         * Chrome 68はshadow DOM内のidを参照、\n         * Firefox 61はグローバル DOMのidを参照、\n         * Safariは解決を未実装\n         * 以下は、Firefox用ワークアラウンド。グローバルにdefsを追加。\n         */\n        const defs = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n        defs.setAttributeNS(null, 'version', '1.1')\n        defs.setAttribute('xmlns', 'http://www.w3.org/2000/svg');\n        defs.setAttribute('xmlns:xlink', 'http://www.w3.org/1999/xlink');\n        defs.setAttribute('width', '0');\n        defs.setAttribute('height', '0');\n        defs.innerHTML = `\n<defs>\n    <path id=\"two-leaves\" d=\"M196.036,292.977c-16.781-18.297,21.344-105.25-166.266-192.188c-33.563,6.094-79.328,160.156,118.984,212.031\n    c65.594,21.344,57.969,94.563,57.969,122.016h38.125c0,0-15.594-87.094,54.078-119.016\n    c47.406-21.688,178.328-28.656,213.078-224.281c-66.234-38.313-281.625-7.75-276.266,186.313\n    c-3.141,27.297-4.703,50.422-19.875,44.109C197.567,314.336,196.036,292.977,196.036,292.977z\" opacity=\"0.5\" />\n</defs>\n<defs>\n    <g id=\"seedlings\">\n        <use xlink:href=\"#two-leaves\" transform=\"translate(-80,-80) scale(0.07,0.07)\"></use>\n        <use xlink:href=\"#two-leaves\" transform=\"translate(-15,-80) scale(0.07,0.07)\"></use>\n        <use xlink:href=\"#two-leaves\" transform=\"translate(55,-80) scale(0.07,0.07)\"></use>\n        <use xlink:href=\"#two-leaves\" transform=\"translate(120,-80) scale(0.07,0.07)\"></use>\n        <use xlink:href=\"#two-leaves\" transform=\"translate(-60,-15) scale(0.07,0.07)\"></use>\n        <use xlink:href=\"#two-leaves\" transform=\"translate(15,-15) scale(0.07,0.07)\"></use>\n        <use xlink:href=\"#two-leaves\" transform=\"translate(75,-15) scale(0.07,0.07)\"></use>\n        <use xlink:href=\"#two-leaves\" transform=\"translate(140,-15) scale(0.07,0.07)\"></use>\n        <use xlink:href=\"#two-leaves\" transform=\"translate(-80,55) scale(0.07,0.07)\"></use>\n        <use xlink:href=\"#two-leaves\" transform=\"translate(-15,55) scale(0.07,0.07)\"></use>\n        <use xlink:href=\"#two-leaves\" transform=\"translate(55,55) scale(0.07,0.07)\"></use>\n        <use xlink:href=\"#two-leaves\" transform=\"translate(120,55) scale(0.07,0.07)\"></use>\n        <use xlink:href=\"#two-leaves\" transform=\"translate(-60,120) scale(0.07,0.07)\"></use>\n        <use xlink:href=\"#two-leaves\" transform=\"translate(15,120) scale(0.07,0.07)\"></use>\n        <use xlink:href=\"#two-leaves\" transform=\"translate(75,120) scale(0.07,0.07)\"></use>\n        <use xlink:href=\"#two-leaves\" transform=\"translate(140,120) scale(0.07,0.07)\"></use>\n    </g>\n</defs>\n<defs>\n    <path\n    id=\"leaf\"\n    d=\"m 0,-145 c -5.36199,-1.5478604 -14.21002,-8.6465004 -15.2827,-22.05113 -1.07198,-13.40533 13.94132,-32.17336 16.35468,-37.80264 2.41335,-5.63069 5.89798,0.53528 10.72469,5.36199 4.826,4.82601 31.099959,32.70794 -3.21876,54.1573096 -2.1991,1.3477504 -2.12414,2.5074104 -1.84201,5.7565604 0.4773,5.48079 1.34068,4.67681 0.86479,5.39169 -0.94116,1.41068 -4.76802,1.98344 -4.7666,0.4773 -0.001,-8.58004 -3.771,-25.1482604 -0.50983,-37.92426 4.29002,-16.80157 1.5521,-19.18452 1.5521,-19.18452 0,0 -1.6617,10.93895 -3.51856,18.29286 -4.46821,17.69534958 -0.3578,27.52484 -0.3578,27.52484 z\"/>\n</defs>\n<defs>\n    <g id=\"four-leaves\">\n        <use xlink:href=\"#leaf\" transform=\"rotate(0)\" />\n        <use xlink:href=\"#leaf\" transform=\"rotate(90)\" />\n        <use xlink:href=\"#leaf\" transform=\"rotate(180)\" />\n        <use xlink:href=\"#leaf\" transform=\"rotate(270)\" />\n    </g>\n</defs>\n`;\n        document.body.appendChild(defs);\n        // ワークアラウンド終わり\n        this.prototype.template = document.createElement('template');\n        this.prototype.template.id = 'allelo-board';\n        this.prototype.template.innerHTML = `\n<style>\n    :host {\n        display: inline-block;  /* or display: block; */\n    }\n    .container {\n        position: relative;\n        padding: 10px;\n    }\n    canvas {\n        display: block; /* デフォルトのinlineのままだとcanvasの下に隙間が入る */\n    }\n    #goban {\n        position: relative;\n    }\n    #territory, #leaves, #stones, #bans {\n        position: absolute;\n        top: 10px; /* .containerのpaddingと同じ値 TODO リファクタリング */\n        left: 10px; /* .containerのpaddingと同じ値 TODO リファクタリング */\n    }\n    svg * {\n        width: 100%;\n        height: 100%;\n    }\n    #bans {\n        pointer-events: none;\n    }\n</style>\n<div class=\"container\", style=\"background-color: orange;\">\n    <canvas id=\"goban\"></canvas>\n    <svg id=\"territory\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n        <defs>\n            <path id=\"two-leaves\" d=\"M196.036,292.977c-16.781-18.297,21.344-105.25-166.266-192.188c-33.563,6.094-79.328,160.156,118.984,212.031\n            c65.594,21.344,57.969,94.563,57.969,122.016h38.125c0,0-15.594-87.094,54.078-119.016\n            c47.406-21.688,178.328-28.656,213.078-224.281c-66.234-38.313-281.625-7.75-276.266,186.313\n            c-3.141,27.297-4.703,50.422-19.875,44.109C197.567,314.336,196.036,292.977,196.036,292.977z\" opacity=\"0.5\" />\n        </defs>\n        <defs>\n            <g id=\"seedlings\">\n                <use xlink:href=\"#two-leaves\" transform=\"translate(-80,-80) scale(0.07,0.07)\"></use>\n                <use xlink:href=\"#two-leaves\" transform=\"translate(-15,-80) scale(0.07,0.07)\"></use>\n                <use xlink:href=\"#two-leaves\" transform=\"translate(55,-80) scale(0.07,0.07)\"></use>\n                <use xlink:href=\"#two-leaves\" transform=\"translate(120,-80) scale(0.07,0.07)\"></use>\n                <use xlink:href=\"#two-leaves\" transform=\"translate(-60,-15) scale(0.07,0.07)\"></use>\n                <use xlink:href=\"#two-leaves\" transform=\"translate(15,-15) scale(0.07,0.07)\"></use>\n                <use xlink:href=\"#two-leaves\" transform=\"translate(75,-15) scale(0.07,0.07)\"></use>\n                <use xlink:href=\"#two-leaves\" transform=\"translate(140,-15) scale(0.07,0.07)\"></use>\n                <use xlink:href=\"#two-leaves\" transform=\"translate(-80,55) scale(0.07,0.07)\"></use>\n                <use xlink:href=\"#two-leaves\" transform=\"translate(-15,55) scale(0.07,0.07)\"></use>\n                <use xlink:href=\"#two-leaves\" transform=\"translate(55,55) scale(0.07,0.07)\"></use>\n                <use xlink:href=\"#two-leaves\" transform=\"translate(120,55) scale(0.07,0.07)\"></use>\n                <use xlink:href=\"#two-leaves\" transform=\"translate(-60,120) scale(0.07,0.07)\"></use>\n                <use xlink:href=\"#two-leaves\" transform=\"translate(15,120) scale(0.07,0.07)\"></use>\n                <use xlink:href=\"#two-leaves\" transform=\"translate(75,120) scale(0.07,0.07)\"></use>\n                <use xlink:href=\"#two-leaves\" transform=\"translate(140,120) scale(0.07,0.07)\"></use>\n            </g>\n        </defs>\n    </svg>\n    <svg id=\"leaves\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n        <defs>\n            <path\n            id=\"leaf\"\n            d=\"m 0,-145 c -5.36199,-1.5478604 -14.21002,-8.6465004 -15.2827,-22.05113 -1.07198,-13.40533 13.94132,-32.17336 16.35468,-37.80264 2.41335,-5.63069 5.89798,0.53528 10.72469,5.36199 4.826,4.82601 31.099959,32.70794 -3.21876,54.1573096 -2.1991,1.3477504 -2.12414,2.5074104 -1.84201,5.7565604 0.4773,5.48079 1.34068,4.67681 0.86479,5.39169 -0.94116,1.41068 -4.76802,1.98344 -4.7666,0.4773 -0.001,-8.58004 -3.771,-25.1482604 -0.50983,-37.92426 4.29002,-16.80157 1.5521,-19.18452 1.5521,-19.18452 0,0 -1.6617,10.93895 -3.51856,18.29286 -4.46821,17.69534958 -0.3578,27.52484 -0.3578,27.52484 z\"/>\n        </defs>\n        <defs>\n            <g id=\"four-leaves\">\n                <use xlink:href=\"#leaf\" transform=\"rotate(0)\" />\n                <use xlink:href=\"#leaf\" transform=\"rotate(90)\" />\n                <use xlink:href=\"#leaf\" transform=\"rotate(180)\" />\n                <use xlink:href=\"#leaf\" transform=\"rotate(270)\" />\n            </g>\n        </defs>\n    </svg>\n    <canvas id=\"stones\"></canvas>\n    <canvas id=\"bans\"></canvas>\n</div>\n<script id=\"vs\" type=\"x-shader/x-vertex\">\n    attribute vec2 position;\n\n    void main() {\n        // position specifies only x and y.\n        // We set z to be 0.0, and w to be 1.0\n        gl_Position = vec4(position, 0.0, 1.0);\n    }\n</script>\n<script id=\"fs\" type=\"x-shader/x-fragment\">\n    precision lowp float;\n    const int BOARD_WIDTH = %BOARD_WIDTH%;\n    const int BOARD_HEIGHT = %BOARD_HEIGHT%;\n    const float WIDTH = %WIDTH%.0;\n    const float HEIGHT = %HEIGHT%.0;\n    uniform float states[BOARD_WIDTH * BOARD_HEIGHT];\n    \n    void main() {\n        float _width = WIDTH / float(BOARD_WIDTH) / 2.0;\n        float _height = HEIGHT / float(BOARD_HEIGHT) / 2.0;\n        float x = gl_FragCoord.x;\n        float y = gl_FragCoord.y;\n        float b = 0.0;\n        float w = 0.0;\n        for (int j = 0; j < BOARD_HEIGHT; j++) {\n            for (int i = 0; i < BOARD_WIDTH; i++) {\n                float r = states[i + j * BOARD_WIDTH];\n                float dx = _width + float(i) * 2.0 * _width - x;\n                float dy = _height + float(j) * 2.0 * _height - (HEIGHT - y);\n                float ratio = r*r/(dx*dx + dy*dy);\n                ratio = ratio * ratio;\n                ratio = ratio * ratio;\n                ratio = ratio * ratio;\n                if (r > 0.0) {\n                    b += ratio;\n                } else {\n                    w += ratio;\n                }\n            }\n        }\n        float alpha = float(b > 1.0 || w > 1.0);\n        float white = float(w > 1.0);\n        // gl_FragColor = vec4(0.0, white + 0.3, 0.0, alpha);\n        // Firefox 61はalphaが0でも色が透過に影響するのでそのワークアラウンドでalphaを色にも掛ける。\n        gl_FragColor = vec4(0.0, (white + 0.3) * alpha, 0.0, alpha);\n    }\n</script>\n`;\n        customElements.define('allelo-board', this);\n    }\n\n    constructor() {\n        super();\n        let shadowRoot = this.attachShadow({mode: 'open'});\n        const instance = this.template.content.cloneNode(true);\n        shadowRoot.appendChild(instance);\n        if (this.dataset.stoneSize != null && this.dataset.width != null && this.dataset.height != null) {\n            this.initialize(\n                parseFloat(this.dataset.stoneSize),\n                parseInt(this.dataset.width),\n                parseInt(this.dataset.height)\n            );\n        }\n    }\n\n    static get observedAttributes() {\n        return [\n            'data-stone-size',\n            'data-width',\n            'data-height'\n        ];\n    }\n\n    connectedCallback() {\n        console.log('connectedCallback');\n    }\n\n    disconnectedCallback() {\n        console.log('disconnectedCallback');\n    }\n\n    adoptedCallback() {\n        console.log('adoptedCallback');\n    }\n\n    attributeChangedCallback(name, oldvalue, newValue) {\n        if (\n            this.alleloBoard != null ||\n            this.dataset.stoneSize == null ||\n            this.dataset.width == null ||\n            this.dataset.height == null\n        ) {\n            // 既に初期化済かまだパラメータが揃っていないか。\n            return;\n        }\n        this.initialize(\n            parseFloat(this.dataset.stoneSize),\n            parseInt(this.dataset.width),\n            parseInt(this.dataset.height)\n        );\n    }\n\n    drawGround(goban, stoneSize) {\n        const ctx = goban.getContext('2d');\n        ctx.lineWidth = 1;\n        ctx.strokeStyle = 'rgb(0, 0, 0)';\n        const halfSize = stoneSize / 2;\n        const groundImage = new Image();\n        groundImage.onload = () => {\n            // dataURLでも画像がロードされるまでに時間差がある模様\n            // ここで勝利しないとgroundPatternが真っ黒。\n            const groundPattern = ctx.createPattern(groundImage, 'repeat');\n            function drawIntersections() {\n                for (let y = halfSize; y < goban.height; y += stoneSize) {\n                    for (let x = halfSize; x < goban.width; x += stoneSize) {\n                        ctx.fillStyle = 'rgb(196, 127, 51)';\n                        ctx.fillRect(x - halfSize, y - halfSize, stoneSize, stoneSize);\n                        ctx.fillStyle = groundPattern;\n                        ctx.fillRect(x - halfSize, y - halfSize, stoneSize, stoneSize);\n                        ctx.beginPath();\n                        ctx.fillStyle = 'black';\n                        ctx.arc(x, y, halfSize / 20, 0, Math.PI*2, false);\n                        ctx.fill();\n                    }\n                }\n            }\n            //drawLines();\n            drawIntersections.call(this);\n            if (this.onready) {\n                this.onready();\n            }\n        }\n        groundImage.src = 'data:image/png;base64,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';\n    }\n\n    initialize(stoneSize, boardWidth, boardHeight) {\n        const goban = this.shadowRoot.querySelector('#goban');\n        goban.width = stoneSize * boardWidth;\n        goban.height = stoneSize * boardHeight;\n        this.drawGround(goban, stoneSize);\n\n        const leaves = this.shadowRoot.querySelector('#leaves');\n        leaves.setAttribute('width', `${goban.width}px`);\n        leaves.setAttribute('height', `${goban.height}px`);\n        const scale = stoneSize * 0.0036;\n        for (let y = 1; y <= boardHeight; y++) {\n            for (let x = 1; x <= boardWidth; x++) {\n                const fourLeaves = document.createElementNS('http://www.w3.org/2000/svg', 'use');\n                fourLeaves.id = `leaf-${x - 1 + (y - 1) * boardWidth}`;\n                fourLeaves.setAttributeNS('http://www.w3.org/1999/xlink', 'href', '#four-leaves');\n                fourLeaves.setAttribute('transform', `translate(${x * stoneSize - stoneSize / 2},${y * stoneSize - stoneSize / 2}) scale(${scale})`);\n                fourLeaves.setAttribute('display', 'none');\n                fourLeaves.classList.add('four-leaves');\n                leaves.appendChild(fourLeaves);\n            }\n        }\n        const territory = this.shadowRoot.querySelector('#territory');\n        territory.setAttribute('width', `${goban.width}px`);\n        territory.setAttribute('height', `${goban.height}px`);\n        for (let y = 1; y <= boardHeight; y++) {\n            for (let x = 1; x <= boardWidth; x++) {\n                const karakusa = document.createElementNS('http://www.w3.org/2000/svg', 'use');\n                karakusa.id = `territory-${x - 1 + (y - 1) * boardWidth}`;\n                karakusa.setAttributeNS('http://www.w3.org/1999/xlink', 'href', '#seedlings');\n                karakusa.setAttribute('transform', `translate(${x * stoneSize - stoneSize * 2 / 3},${y * stoneSize - stoneSize * 2 / 3}) scale(${scale})`);\n                karakusa.setAttribute('display', 'none');\n                karakusa.classList.add('territory');\n                territory.appendChild(karakusa);\n            }\n        }\n        const bans = this.shadowRoot.querySelector('#bans');\n        bans.width = goban.width;\n        bans.height = goban.height;\n        this.alleloBoard = new AlleloBoard(stoneSize, boardWidth, boardHeight, this.shadowRoot);\n    }\n\n    setBans(bans) {\n        const canvas = this.shadowRoot.querySelector('#bans');\n        const stoneSize = canvas.width / parseInt(this.dataset.width);\n        const ctx = canvas.getContext('2d');\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\n        const background = this.shadowRoot.querySelector('.container').style.backgroundColor;\n        for (const ban of bans) {\n            ctx.fillStyle = background;\n            ctx.fillRect((ban[0] - 1) * stoneSize, (ban[1] - 1) * stoneSize, stoneSize, stoneSize);\n        }\n    }\n}\n\nexport default AlleloBoardElement; ","/**\n * @preserve Copyright 2020 ICHIKAWA, Yuji (New 3 Rs)\n */\n\nimport React, { RefObject } from \"react\";\nimport AlleloBoardElement from \"./allelo-board\";\nimport { GoPosition, GoPlayMove, BLACK, WHITE } from \"./GoPosition\";\n\ndeclare global {\n    namespace JSX {\n        interface IntrinsicElements {\n            'allelo-board': React.DetailedHTMLProps<React.HTMLAttributes<HTMLElement>, HTMLElement>;\n        }\n    }\n}\nAlleloBoardElement.init();\n\ninterface Props {\n    position: GoPosition;\n    onClick: (x: number, y: number) => void;\n}\ninterface State {\n    animation: Boolean;\n}\n\nclass AlleloBoard extends React.Component<Props, State> {\n    boardRef: RefObject<AlleloBoardElement>;\n\n    constructor(props: Props) {\n        super(props);\n        this.boardRef = React.createRef();\n        this.state = { animation: false };\n    }\n\n    render() {\n        return (\n            <allelo-board ref={this.boardRef} data-stone-size=\"100\" data-width={this.props.position.WIDTH} data-height={this.props.position.HEIGHT}></allelo-board>\n        );\n    }\n\n    componentDidMount() {\n        this.boardRef?.current?.alleloBoard?.addEventListener('click', (x: number, y: number) => {\n            this.onClick(x, y);\n        });\n    }\n\n    componentWillUnmount() {\n        this.boardRef?.current?.alleloBoard?.removeEventListener('click', undefined);\n    }\n\n    onClick(x: number, y: number) {\n        if (this.state.animation) {\n            return;\n        }\n        this.props.onClick(x, y);\n    }\n\n    async play(position: GoPosition, x: number, y: number, result: GoPlayMove) {\n        if (this.state.animation) {\n            return;\n        }\n        this.setState({ animation: true });\n        const index = position.xyToPoint(x, y);\n        const state = new Float32Array(position.LENGTH);\n        for (let i = 0; i < state.length; i++) {\n            switch (position.getState(i)) {\n                case BLACK:\n                state[i] = 1.0;\n                break;\n                case WHITE:\n                state[i] = -1.0;\n                break;\n                default:\n                state[i] = 0.0;\n            }\n        }\n        await this.boardRef?.current?.alleloBoard?.drawStone(state, result.turn === BLACK ? 1.0 : -1.0, index, result.captives);\n        this.setState({ animation: false });\n    }\n\n    async clear() {\n        const state = new Float32Array(this.props.position.WIDTH * this.props.position.HEIGHT);\n        await this.boardRef?.current?.alleloBoard?.drawStone(state, 1.0, null);\n    }\n}\n\nexport default AlleloBoard;\n","/**\n * @preserve Copyright 2019 ICHIKAWA, Yuji (New 3 Rs)\n */\n\n /**\n  * #input #output DOMを通じてエンジンと通信するクラス\n  */\nclass Gtp {\n    static shared = new Gtp()\n    constructor() {\n        this.inputDom = document.getElementById(\"input\");\n        this.outputDom = document.getElementById(\"output\");\n        this.outputDom.addEventListener(\"message\", event => {\n            this.process(event.currentTarget.value);\n            event.currentTarget.value = \"\";\n        }, false);\n    }\n\n    _command(str) {\n        this.inputDom.command.value = str;\n        // submitメソッドはイベントハンドラを走らせないのでdispachEventを使う\n        this.inputDom.dispatchEvent(new CustomEvent('submit'));\n    }\n\n    command(str) {\n        return new Promise((res, rej) => {\n            if (this.inputDom.command.getAttribute(\"disabled\") != null) {\n                return;\n            }\n            this.LzAnalyzeHandler = null;\n            this.resolve = res;\n            this.reject = rej;\n            this._command(str);\n        });\n    }\n\n    lzAnalyze(interval, handler) {\n        if (this.inputDom.command.getAttribute(\"disabled\") != null) {\n            return;\n        }\n        this.LzAnalyzeHandler = handler;\n        this._command(`lz-analyze ${interval}`);\n    }\n\n    kataAnalyze(interval, handler) {\n        if (this.inputDom.command.getAttribute(\"disabled\") != null) {\n            return;\n        }\n        this.kataAnalyzeHandler = handler;\n        this._command(`kata-analyze ${interval} ownership true`);\n    }\n\n    process(line) {\n        if (line.startsWith(\"=\")) {\n            if (this.resolve) {\n                this.resolve(line);\n                this.resolve = null;;\n            }\n        } else if (line.startsWith(\"?\")) {\n            if (this.reject) {\n                this.reject(line);\n                this.reject = null;;\n            }\n        }\n        if (this.LzAnalyzeHandler) {\n            this.parseLzAnalyze(line);\n        }\n        if (this.kataAnalyzeHandler) {\n            this.parseKataAnalyze(line);\n        }\n    }\n\n    parseLzAnalyze(line) {\n        // info move C4 visits 2 winrate 4861 prior 1307 lcb -5139 order 0 pv C4 Q17 info move Q17 visits 2 winrate 4905 prior 1098 lcb -5095 order 1 pv Q17 Q3 info move Q3 visits 2 winrate 4870 prior 1089 lcb -5130 order 2 pv Q3 Q17 info move Q4 visits 2 winrate 4934 prior 915 lcb -5066 order 3 pv Q4 Q17 info move Q16 visits 2 winrate 4940 prior 900 lcb -5060 order 4 pv Q16 Q3 info move D3 visits 0 winrate 4120 prior 853 lcb -5880 order 5 pv D3\n        const regex = /info move ([A-Z]\\d{1,2}) visits (\\d+) winrate (\\d+) prior (-?\\d+) lcb (-?\\d+) order (\\d+) pv ((:? ?[A-Z]\\d{1,2})+)/g;\n        const result = [];\n        let match;\n        while ((match = regex.exec(line)) != null) {\n            result.push({\n                move: match[1],\n                visits: parseInt(match[2]),\n                winrate: parseInt(match[3]) / 10000,\n                prior: parseInt(match[4]),\n                lcb: parseInt(match[5]),\n                orer: parseInt(match[6]),\n                pv: match[7].split(\" \")\n            });\n        }\n        this.LzAnalyzeHandler(result);\n    }\n\n    parseKataAnalyze(line) {\n        // info move C16 visits 56 utility -0.0194507 radius 0.00739696 winrate 0.491428 scoreMean -0.478044 scoreStdev 32.3095 prior 0.105269 lcb 0.488786 utilityLcb -0.0268477 order 0 pv C16 D3 R16 Q3 info move Q17 visits 53 utility -0.0205986 radius 0.00789271 winrate 0.490967 scoreMean -0.51843 scoreStdev 32.3086 prior 0.103317 lcb 0.488148 utilityLcb -0.0284914 order 1 pv Q17 R4 C4 D17 info move R16 visits 48 utility -0.0213819 radius 0.00722001 winrate 0.490688 scoreMean -0.558307 scoreStdev 32.284 prior 0.0935492 lcb 0.48811 utilityLcb -0.0286019 order 2 pv R16 D17 Q3 C4 info move Q3 visits 48 utility -0.02044 radius 0.00754151 winrate 0.491073 scoreMean -0.52743 scoreStdev 32.2601 prior 0.0914671 lcb 0.48838 utilityLcb -0.0279815 order 3 pv Q3 C4 C16 Q17 info move D17 visits 46 utility -0.0203694 radius 0.00863686 winrate 0.491095 scoreMean -0.523149 scoreStdev 32.3207 prior 0.0878046 lcb 0.48801 utilityLcb -0.0290062 order 4 pv D17 C4 R4 R16 info move C4 visits 45 utility -0.0197793 radius 0.00917776 winrate 0.491299 scoreMean -0.49066 scoreStdev 32.3245 prior 0.0849676 lcb 0.488021 utilityLcb -0.028957 order 5 pv C4 D17 R4 Q17 info move R4 visits 44 utility -0.0194629 radius 0.00811152 winrate 0.491457 scoreMean -0.490883 scoreStdev 32.3008 prior 0.0829457 lcb 0.488561 utilityLcb -0.0275745 order 6 pv R4 D3 D17 Q17 info move D3 visits 31 utility -0.0191221 radius 0.0111833 winrate 0.491607 scoreMean -0.48426 scoreStdev 32.3926 prior 0.0578495 lcb 0.487613 utilityLcb -0.0303054 order 7 pv D3 R16 Q3 C16 info move Q4 visits 22 utility -0.0124166 radius 0.0190799 winrate 0.494289 scoreMean -0.244886 scoreStdev 32.3341 prior 0.035389 lcb 0.487475 utilityLcb -0.0314966 order 8 pv Q4 C16 Q17 info move D16 visits 21 utility -0.011348 radius 0.0169283 winrate 0.494768 scoreMean -0.224796 scoreStdev 32.3515 prior 0.0329591 lcb 0.488722 utilityLcb -0.0282763 order 9 pv D16 R4 Q17 info move Q16 visits 20 utility -0.0146187 radius 0.0177249 winrate 0.493477 scoreMean -0.347622 scoreStdev 32.3037 prior 0.034737 lcb 0.487147 utilityLcb -0.0323436 order 10 pv Q16 R4 C4 D17 info move D4 visits 18 utility -0.0106007 radius 0.0247917 winrate 0.495063 scoreMean -0.197694 scoreStdev 32.4116 prior 0.026451 lcb 0.486209 utilityLcb -0.0353924 order 11 pv D4 D17 R16 ownership 0.0574604 0.0927184 0.0862007 0.0889222 0.0713715 0.0705342 0.0663168 0.0699454 0.0696961 0.0703135 0.0707498 0.0720875 0.0683848 0.0697193 0.0657052 0.0811097 0.0803288 0.0891219 0.0589881 0.09508 0.0887696 0.0856517 0.0567618 0.0538765 0.0454831 0.037413 0.0424316 0.0418428 0.0414332 0.0427052 0.0438007 0.0401999 0.0443078 0.04858 0.0488899 0.0744198 0.0782437 0.0795875 0.0927124 0.0970239 0.068805 0.0359063 0.027807 0.040289 0.0323884 0.0359301 0.0319725 0.0286396 0.0314628 0.0330162 0.0307161 0.0350543 0.0235283 0.020687 0.0460025 0.073326 0.0802772 0.102314 0.0730797 0.0559703 0.0428388 0.0478558 0.0374339 0.0321411 0.0350915 0.032562 0.0320581 0.0322501 0.0338105 0.0301837 0.029372 0.0364939 0.0338301 0.0170987 0.0471682 0.0860232 0.0806405 0.06963 0.0410239 0.0474705 0.0264108 0.028095 0.0277513 0.0269129 0.025512 0.0257056 0.0253849 0.0268678 0.0262896 0.0218693 0.0223549 0.0386803 0.0254255 0.0511993 0.0714695 0.0758416 0.0510583 0.039525 0.0360652 0.0254357 0.024569 0.0223601 0.0146071 0.0127407 0.0131719 0.0130609 0.0145692 0.020976 0.0232113 0.0236705 0.0341295 0.038488 0.0405238 0.0703722 0.0724104 0.0408933 0.0345678 0.033456 0.0273286 0.0214489 0.0109052 0.00227355 1.36716e-05 7.0059e-05 -0.000410544 0.00066663 0.00918381 0.0199694 0.0284545 0.0308396 0.0304586 0.0345143 0.0668094 0.072015 0.0414706 0.0365848 0.0383315 0.0287511 0.014852 0.00129122 -0.00670995 -0.0096296 -0.00890338 -0.009229 -0.00681303 0.00073803 0.0125068 0.0282436 0.033793 0.0327075 0.0415581 0.0722434 0.0677752 0.0390562 0.0333236 0.0353017 0.0260784 0.0115204 -0.0021702 -0.0113931 -0.0153548 -0.0147816 -0.014332 -0.0103502 -0.00193408 0.0102372 0.0246196 0.0313203 0.0286652 0.0404499 0.071719 0.0652687 0.0371737 0.0271852 0.0320029 0.0244574 0.0101729 -0.00306306 -0.0122747 -0.0168854 -0.0162893 -0.0162496 -0.0113587 -0.00237764 0.00981343 0.0236747 0.0300972 0.0250575 0.0373618 0.071067 0.0634167 0.0371166 0.0251066 0.0275254 0.0212085 0.00748802 -0.00544358 -0.0136066 -0.0178959 -0.0181945 -0.0177597 -0.0128457 -0.00337375 0.00914089 0.0226917 0.0299255 0.0269413 0.0340216 0.0690287 0.0610828 0.0350292 0.0234277 0.0245448 0.0195385 0.00625186 -0.00509413 -0.011918 -0.0136773 -0.0126529 -0.0125938 -0.00954261 -0.00163155 0.0104468 0.0230677 0.0297651 0.0248561 0.0325079 0.0667663 0.0530989 0.0241485 0.0167402 0.0170874 0.0144973 0.0102617 0.00225149 -0.00486142 -0.00583227 -0.00427596 -0.00443261 -0.00260952 0.00667355 0.0165172 0.0215436 0.0231393 0.0177754 0.0248205 0.0616455 0.0496837 0.0235134 0.0107289 0.0131149 0.00576788 0.0106886 0.0100019 0.00467538 0.00352945 0.00487139 0.00469349 0.00734111 0.014891 0.0163271 0.0148882 0.0227564 0.0179868 0.0292976 0.0605091 0.0454176 0.0215302 -0.00957254 0.00772825 0.00449392 0.00775453 0.013559 0.0158508 0.0147453 0.0162791 0.0170412 0.0195928 0.0195486 0.0157745 0.0127525 0.0227294 0.0123397 0.0336789 0.0560846 0.0524011 0.00537971 -0.0367772 0.0201121 0.00255268 0.00633342 0.0112068 0.0194867 0.0195896 0.0213024 0.021994 0.0238675 0.0197127 0.0185881 0.0267457 0.0271527 0.00493118 0.0321386 0.0680206 0.0320382 0.0248312 -0.0121598 -0.0560937 -0.016586 0.0033388 0.010258 0.0191786 0.0191341 0.0169894 0.0206722 0.0221256 0.0157605 0.0197785 0.0122782 -0.00640326 0.0215207 0.0570617 0.0569199 0.0235893 0.0244588 0.0171742 -0.00940123 0.00497656 0.0136249 0.0109796 0.0211825 0.0241471 0.0261304 0.0284791 0.0278052 0.0240433 0.0307363 0.0356951 0.0270279 0.0523358 0.0552047 0.0552847 -0.00718682 0.0239468 0.0142311 0.0338551 0.0278807 0.0416977 0.0494086 0.0593436 0.0604753 0.0625834 0.0626572 0.0633467 0.0566236 0.0559152 0.0495887 0.0620285 0.051852 0.0538323 0.0218319\n        const regex = /info move ([A-Z]\\d{1,2}) visits (\\d+) utility (-?\\d+\\.\\d+(?:e-?\\d+)?) radius (-?\\d+\\.\\d+(?:e-?\\d+)?) winrate (-?\\d+\\.\\d+(?:e-?\\d+)?) scoreMean (-?\\d+\\.\\d+(?:e-?\\d+)?) scoreStdev (-?\\d+\\.\\d+(?:e-?\\d+)?) prior (-?\\d+\\.\\d+(?:e-?\\d+)?) lcb (-?\\d+\\.\\d+(?:e-?\\d+)?) utilityLcb (-?\\d+\\.\\d+(?:e-?\\d+)?) order (-?\\d+) pv ((?: ?[A-Z]\\d{1,2})+)/g;\n        const result = {\n            info: [],\n            ownership: []\n         };\n        let match;\n        while ((match = regex.exec(line)) != null) {\n            result.info.push({\n                move: match[1],\n                visits: parseInt(match[2]),\n                utility: parseFloat(match[3]),\n                radius: parseFloat(match[4]),\n                winrate: parseFloat(match[5]),\n                scoreMean: parseFloat(match[6]),\n                scoreStdev: parseFloat(match[7]),\n                prior: parseFloat(match[8]),\n                lcb: parseFloat(match[9]),\n                utilibyLcb: parseFloat(match[10]),\n                order: parseInt(match[11]),\n                pv: match[12].split(\" \")\n            });\n        }\n        if ((match = line.match(/ownership((?: -?\\d+\\.\\d+(?:e-?\\d+)?)+)/)) != null) {\n            result.ownership = match[1].trim().split(\" \");\n        };\n        this.kataAnalyzeHandler(result);\n    }\n}\n\nexport default Gtp;","/**\n * @preserve Copyright 2020 ICHIKAWA, Yuji (New 3 Rs)\n */\n\nimport React, { Component, RefObject } from \"react\";\nimport Modal from \"react-modal\";\nimport { random, sleep } from \"./utilities\";\nimport AlleloBoard from \"./AlleloBoard\";\nimport { GoPosition, GoPlayMove, BLACK, PASS, xy2coord, coord2xy } from \"./GoPosition\";\nimport Gtp from \"./Gtp\";\n\ninterface Props {}\ninterface State {\n    percent: number;\n    black: string;\n    white: string;\n    turn: number;\n    candidates: any[];\n    ownership: any[];\n    modalIsOpen: boolean;\n    modalStyle: any;\n    modalMessage: string;\n    buttonMessage: string;\n}\n\nclass GoBoardController extends Component<Props, State> {\n    size: number;\n    byoyomi: number;\n    model: GoPosition;\n    gtp: Gtp;\n    boardRef: RefObject<AlleloBoard>;\n    modalRef: React.RefObject<Modal>;\n    handicap: number;\n    yourTurn: number;\n\n    constructor(props: Props) {\n        super(props);\n        this.boardRef = React.createRef();\n        this.size = 7;\n        this.byoyomi = 3;\n        this.handicap = 5;\n        this.yourTurn = BLACK;\n        this.model = new GoPosition(this.size, this.size);\n        this.state = {\n            percent: 50,\n            black: \"\",\n            white: \"\",\n            turn: BLACK,\n            candidates: [],\n            ownership: [],\n            modalIsOpen: false,\n            modalStyle: {\n                content: {\n                    top: '50%',\n                    left: '50%',\n                    right: 'auto',\n                    bottom: 'auto',\n                    marginRight: '-50%',\n                    transform: 'translate(-50%, -50%)'\n                }\n            },\n            modalMessage: \"こんにちは！すこし まってね\",\n            buttonMessage: \"とじる\",\n        }\n        this.gtp = Gtp.shared;\n       this.closeModal = this.closeModal.bind(this);\n       this.modalRef = React.createRef();\n    }\n\n    render() {\n        const paragraphs = [];\n        for (const [i, m] of this.state.modalMessage.split(\"\\n\").entries()) {\n            paragraphs.push(<p key={`gbc-p-${i}`}>{m}</p>);\n        }\n        return (\n            <div>\n                <p className=\"align-center\">{this.state.turn === this.yourTurn ? \"あなたのばん\" : \"わたしのばん\"}</p>\n                <AlleloBoard ref={this.boardRef} position={this.model} onClick={async (x: number, y: number) => await this.onClick(x, y)} />\n                <div className=\"align-center\">\n                    <button className=\"button\" onClick={() => { this.pass(); }}>パス</button>\n                    <button className=\"button\" onClick={() => { this.resign(); }}>あきらめる</button>\n                </div>\n                <Modal\n                    ref={this.modalRef}\n                    isOpen={this.state.modalIsOpen}\n                    onRequestClose={this.closeModal}\n                    style={this.state.modalStyle}\n                    contentLabel=\"セリフ\"\n                >\n                    <h2>いごのせんせい</h2>\n                    {paragraphs}\n                    <button onClick={this.closeModal}>{this.state.buttonMessage}</button>\n                </Modal>\n            </div>\n        );\n    }\n\n    async loadWeight() {\n        // webglバックエンドだとウェイトのロードに時間がかかって初回のpredictが遅いのでここで一度ロードしておく。\n        await this.gtp.command(`time_settings 0 1 1`);\n        await this.gtp.command(\"genmove black\");\n    }\n\n    async setRule() {\n        await this.gtp.command(\"komi 0\");\n        await this.gtp.command(`time_settings 0 ${this.byoyomi} 1`);\n    }\n\n    async resetBoard() {\n        await this.gtp.command(\"clear_board\");\n        this.model.clear();\n        await this.boardRef?.current?.clear();\n        this.setState({ turn: this.model.turn });\n    }\n\n    async startGame() {\n        if (this.handicap >= 2) {\n            for (let n = 0; n < this.handicap; n++) {\n                for (;;) {\n                    try {\n                        this.model.turn = BLACK;\n                        const x = random(this.model.WIDTH) + 1;\n                        const y = random(this.model.HEIGHT) + 1;\n                        await this.gtp.command(`play black ${xy2coord(x, y)}`);\n                        await this.play(x, y);\n                        break;\n                    } catch (e) {\n    \n                    }\n                }\n            }\n            await this.enginePlay();\n        }\n    }\n\n    async onClick(x: number, y: number): Promise<void> {\n        let turn = this.model.turn;\n        if (turn !== this.yourTurn) {\n            return;\n        }\n        const result = await this.play(x, y);\n        if (result == null) {\n            return;\n        }\n        try {\n            if (!(result.captives.length === 1 && result.captives[0] === result.point)) { // 一子自殺手でなければ\n                await this.gtp.command(`play ${turn === BLACK ? \"black\" : \"white\"} ${xy2coord(x, y)}`);\n            }\n            await this.enginePlay();\n        } catch (e) {\n            console.log(e, result);\n        }\n    }\n\n    async enginePlay() {\n        const turn = this.model.turn;\n        const move = await this.gtp.command(`genmove ${turn === BLACK ? \"black\" : \"white\"}`);\n        if (move === \"= resign\") {\n            await new Promise((res, rej) => {\n                this.setState((state: State, props: Props): any => {\n                    let message = \"あきらめます。まけました。\";\n                    if (this.handicap > 1) {\n                        this.handicap -= 1;\n                    } else {\n                        message += \"\\nつよい！もうおしえることはありません。\\nこのちょうしで、いごのみちをまいしんしてください！\"\n                    }\n                    return {\n                        modalIsOpen: true,\n                        modalMessage: message + \"\\nもう1ゲームしますか？\",\n                        buttonMessage: \"はい\",\n                    }\n                });\n            });\n        } else if (move === \"= pass\") {\n            this.model.play(PASS);\n            this.setState({ turn: this.model.turn });\n            if (this.model.passes < 2) {\n                this.setState((state: State, props: Props): any => {\n                    return {\n                        modalIsOpen: true,\n                        modalMessage: \"パスします\\n(からすことができる きみどりは ぜんぶ からせてください。\\nからすことができる きみどりがなくなったら パスしてください)\",\n                        buttonMessage: \"とじる\",\n                    }\n                });\n            } else {\n                await this.makeScore();\n            }\n        } else {\n            const match = move.match(/^= ([A-Z][0-9]{1,2})/);\n            if (match) {\n                const xy = coord2xy(match[1]);\n                await this.play(xy[0], xy[1]);\n            }\n        }\n    }\n\n    async play(x: number, y: number): Promise<GoPlayMove | null> {\n        const result = this.model.play(this.model.xyToPoint(x, y));\n        if (result != null) {\n            await this.boardRef.current?.play(this.model, x, y, result);\n            this.setState({ turn: this.model.turn });\n            await sleep(0); // ここで1度event loopを手放さないとリーフが描画されないままエンジンが動いてしまう\n        }\n        return result;\n    }\n\n    async pass(): Promise<void> {\n        if (this.model.turn === this.yourTurn) {\n            this.model.play(PASS);\n            if (this.model.passes < 2) {\n                this.setState({ turn: this.model.turn });\n                await this.enginePlay();\n            } else {\n                this.setState({\n                    modalIsOpen: true,\n                    modalMessage: \"おたがいのかずをけいさんします\\nちょっとまってね\",\n                    buttonMessage: \"とじる\",\n                });\n                await this.makeScore();\n            }\n        }\n    }\n\n    async resign(): Promise<void> {\n        if (this.model.turn === this.yourTurn) {\n            this.handicap += 1;\n            this.setState({\n                modalIsOpen: true,\n                modalMessage: \"ありがとうございました\\nもう1ゲームしますか？\",\n                buttonMessage: \"はい\",\n            });\n        }\n    }\n\n    async closeModal(): Promise<void> {\n        this.setState({ modalIsOpen: false });\n        if (this.state.buttonMessage === \"はい\") {\n            await this.resetBoard();\n            await this.startGame();\n        }\n    }\n\n    async makeScore(): Promise<void> {\n        const result = await this.gtp.command(\"final_score\");\n        let message = \"\";\n        if (result === \"= 0\") {\n            message = \"ひきわけですね\";\n        } else {\n            const match = result.match(/^= (B|W)\\+([0-9]+)/);\n            if (match) {\n                if (match[1] === (this.yourTurn === BLACK ? \"B\" : \"W\")) {\n                    message = `あなたの ${match[2]}つ かちですか？\\nまけました。つよいですね`;\n                    if (this.handicap > 0) {\n                        this.handicap -= 1;\n                    }\n                } else {\n                    message = `わたしの ${match[2]}つ かちですか`\n                    this.handicap += 1;\n                }\n            } else {\n                throw new Error(\"should not reach here\");\n            }\n        }\n        this.setState({\n            modalIsOpen: true,\n            modalMessage: message + \"\\nもう1ゲームしますか？\",\n            buttonMessage: \"はい\",\n        });\n    }\n}\n\nexport default GoBoardController;\n","/**\n * @preserve Copyright 2020 ICHIKAWA, Yuji (New 3 Rs)\n */\n\n import React, { Component } from 'react';\nimport Modal from \"react-modal\";\nimport GoBoardController from './GoBoardController';\n\ndeclare global {\n    interface Window { controller: App; }\n}\n\nModal.setAppElement(\"#app-container\");\n\ninterface Props {}\ninterface State {\n    isLoading: boolean;\n    modalIsOpen: boolean;\n    modalMessage: string;\n    modalStyle: any;\n}\n\nclass App extends Component<Props, State> {\n    controllerRef: React.RefObject<GoBoardController>;\n    modalRef: React.RefObject<Modal>;\n\n    constructor(props: Props) {\n        super(props);\n        this.controllerRef = React.createRef();\n        this.modalRef = React.createRef();\n        this.state = {\n            isLoading: true,\n            modalIsOpen: true,\n            modalMessage: \"こんにちは！すこし まってね\",\n            modalStyle: {\n                content: {\n                    top: '50%',\n                    left: '50%',\n                    right: 'auto',\n                    bottom: 'auto',\n                    marginRight: '-50%',\n                    transform: 'translate(-50%, -50%)'\n                }\n            }\n        }\n        this.start = this.start.bind(this);\n        // katagoStatusHandlerでready時に操作するためにグローバル変数にする\n        window.controller = this;\n    }\n\n    render() {\n        const paragraphs = [];\n        for (const [i, m] of this.state.modalMessage.split(\"\\n\").entries()) {\n            paragraphs.push(<p key={`app-p-${i}`}>{m}</p>);\n        }\n        return (\n            <div className=\"container\">\n                <p>ルール</p>\n                {paragraphs}\n                <GoBoardController ref={this.controllerRef} />\n                <small>効果音に<a href=\"https://taira-komori.jpn.org/index.html\">無料効果音で遊ぼう！</a>様の素材を利用させていただいています</small>\n                <Modal\n                    ref={this.modalRef}\n                    isOpen={this.state.modalIsOpen}\n                    style={this.state.modalStyle}\n                    contentLabel=\"あいさつとルール\"\n                >\n                    <h2>いごのせんせい</h2>\n                    {paragraphs}\n                    {this.state.isLoading ? undefined : <button onClick={this.start}>はじめる</button>}\n                </Modal>\n            </div>\n        )\n    }\n\n    onReady() {\n        // イベントループから一度切らないとloadWeightが動かないからsetTimeoutする。\n        setTimeout(async () => {\n            await this.controllerRef.current?.loadWeight();\n            this.setState({\n                isLoading: false,\n                modalMessage: \"みどりをふやすゲームをしましょう\\nあなたはこいみどり、わたしはきみどりです\\nはたけのなかにたくさん みどりをふやしたほうがかちです\\nはっぱをぜんぶかくされると かれます\\nでは、やってみましょう\"\n            });\n        }, 0);\n    }\n\n    async start(): Promise<void> {\n        this.closeModal();\n        await this.controllerRef.current?.setRule();\n        await this.controllerRef.current?.startGame();\n    }\n\n    closeModal() {\n        this.setState({ modalIsOpen: false });\n    }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nif (typeof SharedArrayBuffer !== \"undefined\") {\n  ReactDOM.render(\n    <React.StrictMode>\n      <App />\n    </React.StrictMode>,\n    document.getElementById('app-container')\n  );\n}\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}